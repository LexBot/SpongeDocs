
<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Programador &mdash; documentación de Sponge - 7.2.0</title>

    <link rel="shortcut icon" href="../_static/favicon.ico"/>




    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />

    <link rel="stylesheet" href="../_static/spongedocs.css" type="text/css" />

        <link rel="index" title="Índice"
              href="../genindex.html"/>        <link rel="search" title="Búsqueda" href="../search.html"/>    <link rel="top" title="documentación de Sponge - 7.2.0" href="../index.html"/>        <link rel="up" title="Creando un Plugin" href="index.html"/>        <link rel="next" title="Servicios" href="services.html"/>        <link rel="prev" title="Efectos" href="effects.html"/>
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
    <div id="sp-logo-container" class="page-scroll">
        <a class="logo" href="../index.html">
            <img src="../_static/spongie-mark-dark.svg">
            <span>Sponge</span>
            <i class="fa fa-fw fa-chevron-down"></i>
        </a>
        <div id="sp-logo-menu">
            <ul id="sp-logo-dropdown">
                <li><a href="https://www.spongepowered.org"><i class="fa-fw fa fa-home"></i>Homepage</a></li>
                <li><a href="https://forums.spongepowered.org"><i class="fa-fw fa fa-comments"></i>Forums</a></li>
                <li><a href="https://github.com/SpongePowered"><i class="fa-fw fa fa-code"></i>Code</a></li>
                <li class="active"><a href="https://docs.spongepowered.org"><i class="fa-fw fa fa-book"></i>Docs</a></li>
                <li><a href="https://jd.spongepowered.org"><i class="fa-fw fa fa-graduation-cap"></i>Javadocs</a></li>
                <li><a href="https://forums.spongepowered.org/c/plugins/plugin-releases"><i class="fa-fw fa fa-plug"></i>Plugins</a></li>
                <li><a href="https://ore.spongepowered.org"><img src="../_static/ore.svg" alt="" class="fa-fw fa ore-logo">Ore <sup>Beta</sup></a></li>
                <li><a href="https://www.spongepowered.org/downloads"><i class="fa-fw fa fa-download"></i>Downloads</a></li>
                <li><a href="https://www.spongepowered.org/chat"><i class="fa-fw fa fa-comment"></i>Chat</a></li>
            </ul>
        </div>
    </div>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../server/index.html">Creando un Servidor</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../versions/index.html">Versioning Policy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../preparing/index.html">Preparándose para el Desarrollo</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Creando un Plugin</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="api-versions.html">API-Versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildsystem.html">Sistemas de Compilación</a></li>
<li class="toctree-l2"><a class="reference internal" href="workspace/index.html">Configuración de su Espacio de Trabajo</a></li>
<li class="toctree-l2"><a class="reference internal" href="project/index.html">Configurando Su Proyecto</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-identifier.html">Identificadores de Complementos</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-class.html">Clase de Plug-in Principal</a></li>
<li class="toctree-l2"><a class="reference internal" href="lifecycle.html">Ciclo de vida del Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="injection.html">Inyección de Dependencia</a></li>
<li class="toctree-l2"><a class="reference internal" href="practices/index.html">Prácticas</a></li>
<li class="toctree-l2"><a class="reference internal" href="optional/index.html">Opcionales</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Registro y Depuración</a></li>
<li class="toctree-l2"><a class="reference internal" href="text/index.html">Texto</a></li>
<li class="toctree-l2"><a class="reference internal" href="commands/index.html">Plugin Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="event/index.html">Eventos</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuration/index.html">Configurando Extensiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="assets.html">La API de Activos</a></li>
<li class="toctree-l2"><a class="reference internal" href="data/index.html">La API de Datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="blocks/index.html">Bloques</a></li>
<li class="toctree-l2"><a class="reference internal" href="entities/index.html">Entidades</a></li>
<li class="toctree-l2"><a class="reference internal" href="items/index.html">Articulos</a></li>
<li class="toctree-l2"><a class="reference internal" href="trade-offers.html">Ofertas de Intercambio</a></li>
<li class="toctree-l2"><a class="reference internal" href="effects.html">Efectos</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Programador</a></li>
<li class="toctree-l2"><a class="reference internal" href="services.html">Servicios</a></li>
<li class="toctree-l2"><a class="reference internal" href="database.html">Bases de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="permissions.html">Permisos</a></li>
<li class="toctree-l2"><a class="reference internal" href="bans.html">Baneos</a></li>
<li class="toctree-l2"><a class="reference internal" href="metrics.html">Metrics Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="bookview.html">Vistas del Libro</a></li>
<li class="toctree-l2"><a class="reference internal" href="economy/index.html">Economía</a></li>
<li class="toctree-l2"><a class="reference internal" href="wgen/index.html">Generación de Mundo</a></li>
<li class="toctree-l2"><a class="reference internal" href="manager.html">Administrador de Complementos</a></li>
<li class="toctree-l2"><a class="reference internal" href="game-profile-manager.html">Administrador de Perfiles del Juego</a></li>
<li class="toctree-l2"><a class="reference internal" href="offline-userplayer-data.html">Datos del Jugador Fuera de Línea</a></li>
<li class="toctree-l2"><a class="reference internal" href="tab-lists.html">Listas de Tabulaciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="plugin-meta.html">Metadatos del Complemento</a></li>
<li class="toctree-l2"><a class="reference internal" href="ray-tracing.html">Trazado de Rayos (Ray Tracing)</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Depuración de Complemento</a></li>
<li class="toctree-l2"><a class="reference internal" href="tutorials.html">Tutoriales</a></li>
<li class="toctree-l2"><a class="reference internal" href="internals/index.html">Implementation-dependent Plugins</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../ore/index.html">Documentación Ore</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../contributing/index.html">Contribuyendo a Sponge</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../about/index.html">Acerca del proyecto Sponge</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Sponge</a>
      </nav>


      <div class="wy-nav-content">
        <div class="rst-content">

 

<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
          <li><a href="index.html">Creando un Plugin</a> &raquo;</li>
    <li>Programador</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/plugin/scheduler.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
  <div class="section" id="scheduler">
<h1>Programador<a class="headerlink" href="#scheduler" title="Enlazar permanentemente con este título">¶</a></h1>
<p>Sponge expone el :javadoc: <cite>Scheduler</cite> para permitirle designar tareas que se ejecutarán en el futuro. El `` Scheduler`` proporciona un :javadoc: <cite>Task.Builder</cite> con el que puede especificar propiedades de tareas tales como la demora, el intervalo, el nombre, la (a)sincronicidad y el <cite>Runnable`</cite> (ver <span class="xref std std-ref">task -properties</span>).</p>
<div class="section" id="task-builder">
<h2>Compilador de tareas<a class="headerlink" href="#task-builder" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Primero, obtenga una instancia del `` Task.Builder``:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.scheduler.Task</span><span class="p">;</span>

<span class="n">Task</span><span class="p">.</span><span class="na">Builder</span> <span class="n">taskBuilder</span> <span class="o">=</span> <span class="n">Task</span><span class="p">.</span><span class="na">builder</span><span class="p">();</span>
</pre></div>
</div>
<p>La única propiedad requerida es el <cite>Runnable &lt;https://docs.oracle.com/javase/8/docs/api/java/lang/Runnable.html&gt;</cite> _, que puede especificar usando :javadoc: <a href="#id1"><span class="problematic" id="id2">`</span></a>Task.Builder#execute(Runnable) <a href="#id3"><span class="problematic" id="id4">`</span></a>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">taskBuilder</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;Yay! Schedulers!&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">});</span>
</pre></div>
</div>
<p>o usando la sintaxis de Java 8 con `` Task.Builder#execute(Runnable runnable) ``</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">taskBuilder</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span>
    <span class="p">()</span> <span class="o">-&gt;</span> <span class="p">{</span>
        <span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;Yay! Schedulers!&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<p>o usando la sintaxis de Java 8 con la tarea `` Task.Builder#execute(Consumer&lt;Task&gt;task) ``</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">taskBuilder</span><span class="p">.</span><span class="na">execute</span><span class="p">(</span>
    <span class="n">task</span> <span class="o">-&gt;</span> <span class="p">{</span>
        <span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;Yay! Schedulers! :&quot;</span> <span class="o">+</span> <span class="n">task</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>
    <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="section" id="task-properties">
<span id="id1"></span><h3>Propiedades de tareas<a class="headerlink" href="#task-properties" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Usando el <code class="docutils literal notranslate"><span class="pre">Task.Builder</span></code>, puede especificar otras propiedades opcionales, como se describe a continuación.</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="22%" />
<col width="64%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Propiedad</th>
<th class="head">Método Usado</th>
<th class="head">Descripción</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>retraso</td>
<td><p class="first">delayTicks(retraso largo)</p>
<dl class="last docutils">
<dt>delay(retraso largo,</dt>
<dd>TimeUnit unidad)</dd>
</dl>
</td>
<td><p class="first">La cantidad de tiempo opcional para pasar antes de que la tarea este lista para ser ejecutada.</p>
<p>El tiempo se especifica como un número de tics con el método <code class="docutils literal notranslate"><span class="pre">delayTicks</span> <span class="pre">()</span></code>, o se puede proporcionar como un número de una unidad de tiempo más conveniente al especificar una <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html">TimeUnit</a> con el método de delay().</p>
<p class="last"><em>Cualquiera de los métodos, pero no ambos, puede ser especificado por tarea.</em></p>
</td>
</tr>
<tr class="row-odd"><td>intervalo</td>
<td><dl class="first last docutils">
<dt>intervalTicks(</dt>
<dd>intervalo largo)</dd>
<dt>intervalo(intervalo largo,</dt>
<dd>TimeUnit unidad)</dd>
</dl>
</td>
<td><p class="first">La cantidad de tiempo entre las repeticiones de la tarea. Si no se especifica un intervalo, la tarea no va a ser repetida.</p>
<p>El tiempo se especifica como un número de tics con el método ` intervalTicks() <a href="#id1"><span class="problematic" id="id2">``</span></a>, o puede proporcionarse como un número de una unidad de tiempo más conveniente al especificar una <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/TimeUnit.html">TimeUnit</a> con el método interval().</p>
<p class="last"><em>Cualquiera de los métodos, pero no ambos, puede ser especificado por tarea.</em></p>
</td>
</tr>
<tr class="row-even"><td>sincronización</td>
<td>async()</td>
<td>Una tarea sincrónica se ejecuta en el ciclo principal del juego en serie con el ciclo de tic. Si se utiliza <code class="docutils literal notranslate"><span class="pre">Task.Builder#async</span></code>, la tarea se ejecutará de forma asíncrona. Por lo tanto, se ejecutará en su propio hilo, independientemente del ciclo de tic, y no puede usar con seguridad el estado del juego. (Ver <a class="reference internal" href="#asynchronous-tasks">Asynchronous Tasks</a>.)</td>
</tr>
<tr class="row-odd"><td>nombre</td>
<td>nombre(String nombre)</td>
<td>El nombre de la tarea. Por defecto, el nombre de la tarea será PLUGIN_ID «-» («A-» | «S-«) SERIAL_ID. Por ejemplo, un nombre de tarea predeterminado podría verse como «fooplugin-A-12». No habrá dos tareas activas que tengan la misma identificación de serie para el mismo tipo de sincronización. Si se especifica un nombre de tarea, debe ser descriptivo y ayudar a los usuarios a depurar su complemento.</td>
</tr>
</tbody>
</table>
<p>Por último, envíe la tarea al planificador usando :javadoc: <cite>Task.Builder#submit(Object)</cite>.</p>
<p>¡Y eso es! Para resumir, una tarea programada completamente funcional que se ejecutaría de forma asíncrona cada 5 minutos después de un retraso inicial de 100 milisegundos podría construirse y enviarse utilizando el siguiente código:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.concurrent.TimeUnit</span><span class="p">;</span>

<span class="n">PluginContainer</span> <span class="n">plugin</span> <span class="o">=</span> <span class="p">...;</span>

<span class="n">Task</span> <span class="n">task</span> <span class="o">=</span> <span class="n">Task</span><span class="p">.</span><span class="na">builder</span><span class="p">().</span><span class="na">execute</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&quot;Yay! Schedulers!&quot;</span><span class="p">))</span>
    <span class="p">.</span><span class="na">async</span><span class="p">().</span><span class="na">delay</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">TimeUnit</span><span class="p">.</span><span class="na">MILLISECONDS</span><span class="p">).</span><span class="na">interval</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">TimeUnit</span><span class="p">.</span><span class="na">MINUTES</span><span class="p">)</span>
    <span class="p">.</span><span class="na">name</span><span class="p">(</span><span class="s">&quot;ExamplePlugin - Fetch Stats from Database&quot;</span><span class="p">).</span><span class="na">submit</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
</pre></div>
</div>
<p>Para cancelar una tarea, simplemente llame al método <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/scheduler/Task.html#cancel--">Task#cancel()</a>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">task</span><span class="p">.</span><span class="na">cancel</span><span class="p">();</span>
</pre></div>
</div>
<p>If you need to cancel the task from within the runnable itself, you can instead opt to use a <code class="docutils literal notranslate"><span class="pre">Consumer&lt;Task&gt;</span></code> in
order to access the task. The below example will schedule a task that will count down from 60 and cancel itself upon
reaching 0.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Listener</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onGameInit</span><span class="p">(</span><span class="n">GameInitializationEvent</span> <span class="n">event</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Task</span> <span class="n">task</span> <span class="o">=</span> <span class="n">Task</span><span class="p">.</span><span class="na">builder</span><span class="p">().</span><span class="na">execute</span><span class="p">(</span><span class="k">new</span> <span class="n">CancellingTimerTask</span><span class="p">())</span>
        <span class="p">.</span><span class="na">interval</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">)</span>
        <span class="p">.</span><span class="na">name</span><span class="p">(</span><span class="s">&quot;Self-Cancelling Timer Task&quot;</span><span class="p">).</span><span class="na">submit</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">private</span> <span class="kd">class</span> <span class="nc">CancellingTimerTask</span> <span class="kd">implements</span> <span class="n">Consumer</span><span class="o">&lt;</span><span class="n">Task</span><span class="o">&gt;</span> <span class="p">{</span>
    <span class="kd">private</span> <span class="kt">int</span> <span class="n">seconds</span> <span class="o">=</span> <span class="mi">60</span><span class="p">;</span>
    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">accept</span><span class="p">(</span><span class="n">Task</span> <span class="n">task</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">seconds</span><span class="o">--</span><span class="p">;</span>
        <span class="n">Sponge</span><span class="p">.</span><span class="na">getServer</span><span class="p">()</span>
            <span class="p">.</span><span class="na">getBroadcastChannel</span><span class="p">()</span>
            <span class="p">.</span><span class="na">send</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;Remaining Time: &quot;</span><span class="o">+</span><span class="n">seconds</span><span class="o">+</span><span class="s">&quot;s&quot;</span><span class="p">));</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">seconds</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
            <span class="n">task</span><span class="p">.</span><span class="na">cancel</span><span class="p">();</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p class="last"><strong>Any</strong> scheduled tasks should either watch the current <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/GameState.html">state</a> of the <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/Game.html">Game</a> or
should be unregistered if they are no longer needed (e.g. during a <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/event/game/state/GameStoppingServerEvent.html">GameStoppingServerEvent</a>). This is of
particular importance for the client because it can start and stop the server multiple times.</p>
</div>
</div>
<div class="section" id="asynchronous-tasks">
<h3>Tareas asíncronas<a class="headerlink" href="#asynchronous-tasks" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Las tareas asincrónicas se deben usar principalmente para código que puede llevar un período de tiempo significativo para ejecutarse, como por ejemlplo solicitudes a otro servidor o base de datos. Si se realiza en el hilo principal, una solicitud a otro servidor podría tener un gran impacto en el rendimiento del juego, ya que el siguiente tic no puede iniciarse hasta que se complete la solicitud.</p>
<p>Since Minecraft is largely single-threaded, there is little you can do in an asynchronous thread. If you must run a
thread asynchronously, you should execute all of the code that does not use SpongeAPI/affect Minecraft, then register
another <cite>synchronous</cite> task to handle the code that needs the API. There are a few parts of Minecraft that you can work
with <cite>asynchronously</cite>, including:</p>
<ul class="simple">
<li>Charla</li>
<li>Manejo de Permisos integrado de Sponge</li>
<li>Pranificador de Sponge</li>
</ul>
<p>Además, hay algunas otras operaciones que son seguras para hacer asincrónicamente:</p>
<ul class="simple">
<li>Solicitudes de red independientes</li>
<li>Sistema de archivos I/O (excluidos los archivos utilizados por Sponge)</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p class="last">El acceso a objetos del juego fuera del hilo principal puede provocar bloqueos, inconsistencias y otros problemas, y debe evitarse. Si esto se hace mal, puede obtener una <code class="docutils literal notranslate"><span class="pre">ConcurrentModificationException</span></code> con o sin una caída del servidor en el mejor de los casos y un player/world/server dañado en el peor.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p class="last"><strong>Any</strong> scheduled tasks should either watch the current <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/GameState.html">state</a> of the <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/Game.html">Game</a> or
should be unregistered if they are no longer needed (e.g. during a <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/event/game/state/GameStoppingServerEvent.html">GameStoppingServerEvent</a>). This is of
particular importance for the client because it can start and stop the server multiple times.</p>
</div>
</div>
</div>
<div class="section" id="compatibility-with-other-libraries">
<h2>Compatibilidad con otras bibliotecas<a class="headerlink" href="#compatibility-with-other-libraries" title="Enlazar permanentemente con este título">¶</a></h2>
<p>A medida que su complemente crezca en tamaño y alcance, es posible que desee comenzar a utilizar una de las muchas bibliotecas de concurrencia disponibles para Java y JVM. Estas bibliotecas tienden a soportar el <cite>ExecutorService “de Java &lt;https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/ExecutorService.html&gt;</cite> _ como un medio para dirigir en qué hilo de la tarea es ejecutado.</p>
<p>Para permitir que estas bibliotecas funcionen con <code class="docutils literal notranslate"><span class="pre">Scheduler</span></code> de Sponge, se pueden usar los siguientes métodos:</p>
<ul class="simple">
<li><a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/scheduler/Scheduler.html#createSyncExecutor-java.lang.Object-">Scheduler#createSyncExecutor(Object)</a> crea un <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/scheduler/SpongeExecutorService.html">SpongeExecutorService</a> que ejecuta tareas a través del pranificador sincrónico de Sponge.</li>
<li><a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/scheduler/Scheduler.html#createAsyncExecutor-java.lang.Object-">Scheduler#createAsyncExecutor(Object)</a> crea un <code class="docutils literal notranslate"><span class="pre">SpongeExecutorService</span></code> que ejecuta tareas a través del programador asincrónico de Sponge. Las tareas están sujetas a las restricciones mencionadas en <a class="reference internal" href="#asynchronous-tasks">Asynchronous Tasks</a>.</li>
</ul>
<p>Una cosa a tener en cuenta es que cualquier tarea que interactúe con Sponge fuera de las interacciones listadas en <a class="reference internal" href="#asynchronous-tasks">Asynchronous Tasks</a> necesita ser ejecutada en el ExecutorService creado con ` <cite>Scheduler#createSyncExecutor(Object)</cite> <a href="#id1"><span class="problematic" id="id2">`</span></a>para ser seguro con los subprocesos.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.scheduler.SpongeExecutorService</span><span class="p">;</span>

<span class="n">PluginContainer</span> <span class="n">plugin</span> <span class="o">=</span> <span class="p">...;</span>

<span class="n">SpongeExecutorService</span> <span class="n">minecraftExecutor</span> <span class="o">=</span> <span class="n">Sponge</span><span class="p">.</span><span class="na">getScheduler</span><span class="p">().</span><span class="na">createSyncExecutor</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>

<span class="n">minecraftExecutor</span><span class="p">.</span><span class="na">submit</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">});</span>

<span class="n">minecraftExecutor</span><span class="p">.</span><span class="na">schedule</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="p">{</span> <span class="p">...</span> <span class="p">},</span> <span class="mi">10</span><span class="p">,</span> <span class="n">TimeUnit</span><span class="p">.</span><span class="na">SECONDS</span><span class="p">);</span>
</pre></div>
</div>
<p>Casi todas las bibliotecas tienen alguna forma de adaptar el <code class="docutils literal notranslate"><span class="pre">ExecutorService</span></code> para programar tareas de forma nativa. Como ejemplo, los siguientes párrafos explicarán cómo se usa el `` ExecutorService`` en algunas bibliotecas.</p>
<div class="section" id="completablefuture-java-8">
<h3>CompletableFuture (Java 8)<a class="headerlink" href="#completablefuture-java-8" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Con Java 8, el objeto <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html">CompletableFuture</a> se agregó a la biblioteca estándar. En comparación con el objeto <code class="docutils literal notranslate"><span class="pre">Future</span></code>, esto permite que el desarrollador proporcione una devolución de llamada que se llama cuando el futuro se completa en lugar de bloquear el hilo hasta que el futuro eventualmente se completa.</p>
<p><a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/CompletableFuture.html">CompletableFuture</a> es una interfaz fluida que generalmente tiene las siguientes tres variaciones para cada una de sus funciones:</p>
<ul class="simple">
<li>`` CompletableFuture#&lt;function&gt;Async(…, Executor ex) `` Ejecuta esta función a través de <code class="docutils literal notranslate"><span class="pre">ex</span></code></li>
<li>`` CompletableFuture#&lt;function&gt;Async(…) `` Ejecuta esta función a través de <a href="#id1"><span class="problematic" id="id2">``</span></a>ForkJoinPool.commonPool() ``</li>
<li><code class="docutils literal notranslate"><span class="pre">CompletableFuture#&lt;function&gt;(...)</span></code> Ejecuta esta función en cualquier hilo en el que se haya completado el <code class="docutils literal notranslate"><span class="pre">CompletableFuture</span></code> anterior.</li>
</ul>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.util.concurrent.CompletableFuture</span><span class="p">;</span>

<span class="n">PluginContainer</span> <span class="n">plugin</span> <span class="o">=</span> <span class="p">...;</span>

<span class="n">SpongeExecutorService</span> <span class="n">minecraftExecutor</span> <span class="o">=</span> <span class="n">Sponge</span><span class="p">.</span><span class="na">getScheduler</span><span class="p">().</span><span class="na">createSyncExecutor</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>

<span class="n">CompletableFuture</span><span class="p">.</span><span class="na">supplyAsync</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="p">{</span>
    <span class="c1">// ASYNC: ForkJoinPool.commonPool()</span>
    <span class="k">return</span> <span class="mi">42</span><span class="p">;</span>
<span class="p">}).</span><span class="na">thenAcceptAsync</span><span class="p">((</span><span class="n">awesomeValue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">{</span>
    <span class="c1">// SYNC: minecraftExecutor</span>
<span class="p">},</span> <span class="n">minecraftExecutor</span><span class="p">).</span><span class="na">thenRun</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="p">{</span>
    <span class="c1">// SYNC: minecraftExecutor</span>
<span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="rxjava">
<h3>RxJava<a class="headerlink" href="#rxjava" title="Enlazar permanentemente con este título">¶</a></h3>
<p><cite>RxJava &lt;https://github.com/ReactiveX/RxJava&gt;</cite> _ es una implementación del concepto <a class="reference external" href="http://reactivex.io/">Reactive Extensions</a> para JVM.</p>
<p>El subprocesamiento múltiple en Rx se gestiona a través de varios <a href="#id3"><span class="problematic" id="id4">`Schedulers&lt;http://reactivex.io/documentation/scheduler.html&gt;`_</span></a>. Utilizando la función <code class="docutils literal notranslate"><span class="pre">Schedulers#from(Executor</span> <span class="pre">executor)</span> <span class="pre">``,</span> <span class="pre">el</span> <span class="pre">``Executor</span></code> proporcionado por Sponge se puede convertir en un <code class="docutils literal notranslate"><span class="pre">Scheduler</span></code>.</p>
<p>Al igual que <code class="docutils literal notranslate"><span class="pre">CompletableFuture</span></code> por defecto, las acciones son ejecutadas en el mismo hilo que completó la parte anterior de la cadena. Use <a href="#id1"><span class="problematic" id="id2">``</span></a>Observable#observeOn(Scheduler scheduler) `` para moverse entre hilos.</p>
<p>Una cosa importante a tener en cuenta es que la raíz <code class="docutils literal notranslate"><span class="pre">Observable</span></code> se invoca en cualquier hilo en que <code class="docutils literal notranslate"><span class="pre">Observable#subscribe()</span></code> haya sido invocado. Si la raíz observable interactúa con Sponge, se debe forzar que se ejecute sincrónicamente usando <a href="#id1"><span class="problematic" id="id2">``</span></a>Observable#subscribeOn(Scheduler scheduler) <a href="#id3"><span class="problematic" id="id4">``</span></a>.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">rx.Observable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">rx.Scheduler</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">rx.schedulers.Schedulers</span><span class="p">;</span>

<span class="n">PluginContainer</span> <span class="n">plugin</span> <span class="o">=</span> <span class="p">...;</span>

<span class="n">SpongeExecutorService</span> <span class="n">executor</span> <span class="o">=</span> <span class="n">Sponge</span><span class="p">.</span><span class="na">getScheduler</span><span class="p">().</span><span class="na">createSyncExecutor</span><span class="p">(</span><span class="n">plugin</span><span class="p">);</span>
<span class="n">Scheduler</span> <span class="n">minecraftScheduler</span> <span class="o">=</span> <span class="n">Schedulers</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">executor</span><span class="p">);</span>

<span class="n">Observable</span><span class="p">.</span><span class="na">defer</span><span class="p">(()</span> <span class="o">-&gt;</span> <span class="n">Observable</span><span class="p">.</span><span class="na">from</span><span class="p">(</span><span class="n">Sponge</span><span class="p">.</span><span class="na">getServer</span><span class="p">().</span><span class="na">getOnlinePlayers</span><span class="p">()))</span>
          <span class="p">.</span><span class="na">subscribeOn</span><span class="p">(</span><span class="n">minecraftScheduler</span><span class="p">)</span> <span class="c1">// defer -&gt; SYNC: minecraftScheduler</span>
          <span class="p">.</span><span class="na">observeOn</span><span class="p">(</span><span class="n">Schedulers</span><span class="p">.</span><span class="na">io</span><span class="p">())</span> <span class="c1">// -&gt; ASYNC: Schedulers.io()</span>
          <span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">player</span> <span class="o">-&gt;</span> <span class="p">{</span>
              <span class="c1">// ASYNC: Schedulers.io()</span>
              <span class="k">return</span> <span class="s">&quot;Flards&quot;</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">player</span><span class="p">.</span><span class="na">getName</span><span class="p">());</span>
          <span class="p">})</span>
          <span class="p">.</span><span class="na">observeOn</span><span class="p">(</span><span class="n">minecraftScheduler</span><span class="p">)</span> <span class="c1">// -&gt; SYNC: minecraftScheduler</span>
          <span class="p">.</span><span class="na">subscribe</span><span class="p">(</span><span class="n">player</span> <span class="o">-&gt;</span> <span class="p">{</span>
              <span class="c1">// SYNC: minecraftScheduler</span>
              <span class="n">player</span><span class="p">.</span><span class="na">kick</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;Computer says no&quot;</span><span class="p">));</span>
          <span class="p">});</span>
</pre></div>
</div>
</div>
<div class="section" id="scala">
<h3>Scala<a class="headerlink" href="#scala" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Scala comes with a built-in <a class="reference external" href="https://www.scala-lang.org/api/current/#scala.concurrent.Future">Future</a> object which
a lot of scala framework mirror in design.
Most methods of the Future accept an
<a class="reference external" href="https://www.scala-lang.org/api/current/scala/concurrent/ExecutionContext.html">ExecutionContext</a> which
determined where that part of the operation is executed.
This is different from the CompletableFuture or RxJava since they default to executing on the same thread on which
the previous operation ended.</p>
<p>The fact that all these operations try to implicitly find an <code class="docutils literal notranslate"><span class="pre">ExecutionContext</span></code> means that you can easily use
the default <code class="docutils literal notranslate"><span class="pre">ExecutionContext.global</span></code> and specifically run the parts that need to be thread-safe on the Sponge
server thread.</p>
<p>Para evitar pranificar accidentalmente el trabajo a través del <code class="docutils literal notranslate"><span class="pre">ExecutorContext</span></code> de Sponge, se debe definir implícitamente otro contexto para que actúe como la opción predeterminada. Para mantener la seguridad del hilo, solo las funciones que realmente interactúan con Sponge necesitarán tener especificado el ejecutor de Sponge.</p>
<div class="highlight-scala notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nn">scala.concurrent.ExecutionContext</span>

<span class="k">val</span> <span class="n">executor</span> <span class="k">=</span> <span class="nc">Sponge</span><span class="o">.</span><span class="n">getScheduler</span><span class="o">().</span><span class="n">createSyncExecutor</span><span class="o">(</span><span class="n">plugin</span><span class="o">)</span>

<span class="k">import</span> <span class="nn">ExecutionContext.Implicits.global</span>
<span class="k">val</span> <span class="n">ec</span> <span class="k">=</span> <span class="nc">ExecutionContext</span><span class="o">.</span><span class="n">fromExecutorService</span><span class="o">(</span><span class="n">executor</span><span class="o">)</span>

<span class="k">val</span> <span class="n">future</span> <span class="k">=</span> <span class="nc">Future</span> <span class="o">{</span>
    <span class="c1">// ASYNC: ExecutionContext.Implicits.global</span>
<span class="o">}</span>

<span class="n">future</span> <span class="n">foreach</span> <span class="o">{</span>
    <span class="k">case</span> <span class="n">value</span> <span class="k">=&gt;</span> <span class="c1">// SYNC: ec</span>
<span class="o">}(</span><span class="n">ec</span><span class="o">)</span>

<span class="n">future</span> <span class="n">map</span> <span class="o">{</span>
    <span class="k">case</span> <span class="n">value</span> <span class="k">=&gt;</span> <span class="mi">42</span> <span class="c1">// SYNC: ec</span>
<span class="o">}(</span><span class="n">ec</span><span class="o">).</span><span class="n">foreach</span> <span class="o">{</span>
    <span class="k">case</span> <span class="n">value</span> <span class="k">=&gt;</span> <span class="n">println</span><span class="o">(</span><span class="n">value</span><span class="o">)</span> <span class="c1">// ASYNC: ExecutionContext.Implicits.global</span>
<span class="o">}</span>
</pre></div>
</div>
</div>
</div>
</div>

           </div>
          </div>
<footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="services.html" class="btn btn-neutral float-right" title="Servicios" accesskey="n" rel="next">Siguiente <span class="fa fa-angle-right"></span></a>
        <a href="effects.html" class="btn btn-neutral" title="Efectos" accesskey="p" rel="prev"><span class="fa fa-angle-left"></span> Previo</a>
    </div>

    <hr/>

    <section id="license-footer">
        <p>Except where otherwise noted,
            <a xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" property="dct:title" rel="cc:attributionURL" href="https://github.com/SpongePowered/SpongeDocs">SpongeDocs</a>
            is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
        </p>
        <a id="license-icons" rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" title="CC-BY-SA" aria-hidden="true">cba</a>
    </section>
</footer>        </div>
      </div>

    </section>

  </div>


<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <i class="fa fa-book"> <span>SpongeDocs</span></i>
        v: 7.2.0
    <img src="../_static/flags/es_ES.svg"
         alt="es" title="Español">
        <span class="fa fa-caret-down"></span>
    </span>
    <div id="versions" class="rst-other-versions">




    </div>
</div>

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'7.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>      <script type="text/javascript" src="../_static/jquery.js"></script>      <script type="text/javascript" src="../_static/underscore.js"></script>      <script type="text/javascript" src="../_static/doctools.js"></script>      <script type="text/javascript" src="../_static/language_data.js"></script>      <script type="text/javascript" src="../_static/translations.js"></script>      <script type="text/javascript" src="../_static/spongedocs.js"></script>

    <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
 
</body>
</html>