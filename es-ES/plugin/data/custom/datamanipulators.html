
<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ManipuladoresDeDatos Personalizados &mdash; documentación de Sponge - 7.2.0</title>

    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>




    <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />

    <link rel="stylesheet" href="../../../_static/spongedocs.css" type="text/css" />

        <link rel="index" title="Índice"
              href="../../../genindex.html"/>        <link rel="search" title="Búsqueda" href="../../../search.html"/>    <link rel="top" title="documentación de Sponge - 7.2.0" href="../../../index.html"/>        <link rel="up" title="Datos Personalizados" href="index.html"/>        <link rel="next" title="DataHolders Personalizados" href="dataholders.html"/>        <link rel="prev" title="Datos Personalizados" href="index.html"/>
  <script src="../../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
    <div id="sp-logo-container" class="page-scroll">
        <a class="logo" href="../../../index.html">
            <img src="../../../_static/spongie-mark-dark.svg">
            <span>Sponge</span>
            <i class="fa fa-fw fa-chevron-down"></i>
        </a>
        <div id="sp-logo-menu">
            <ul id="sp-logo-dropdown">
                <li><a href="https://www.spongepowered.org"><i class="fa-fw fa fa-home"></i>Homepage</a></li>
                <li><a href="https://forums.spongepowered.org"><i class="fa-fw fa fa-comments"></i>Forums</a></li>
                <li><a href="https://github.com/SpongePowered"><i class="fa-fw fa fa-code"></i>Code</a></li>
                <li class="active"><a href="https://docs.spongepowered.org"><i class="fa-fw fa fa-book"></i>Docs</a></li>
                <li><a href="https://jd.spongepowered.org"><i class="fa-fw fa fa-graduation-cap"></i>Javadocs</a></li>
                <li><a href="https://forums.spongepowered.org/c/plugins/plugin-releases"><i class="fa-fw fa fa-plug"></i>Plugins</a></li>
                <li><a href="https://ore.spongepowered.org"><img src="../../../_static/ore.svg" alt="" class="fa-fw fa ore-logo">Ore <sup>Beta</sup></a></li>
                <li><a href="https://www.spongepowered.org/downloads"><i class="fa-fw fa fa-download"></i>Downloads</a></li>
                <li><a href="https://www.spongepowered.org/chat"><i class="fa-fw fa fa-comment"></i>Chat</a></li>
            </ul>
        </div>
    </div>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../server/index.html">Creando un Servidor</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../versions/index.html">Versioning Policy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../preparing/index.html">Preparándose para el Desarrollo</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">Creando un Plugin</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../api-versions.html">API-Versions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../buildsystem.html">Sistemas de Compilación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../workspace/index.html">Configuración de su Espacio de Trabajo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../project/index.html">Configurando Su Proyecto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugin-identifier.html">Identificadores de Complementos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugin-class.html">Clase de Plug-in Principal</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../lifecycle.html">Ciclo de vida del Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../injection.html">Inyección de Dependencia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../practices/index.html">Prácticas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../optional/index.html">Opcionales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../logging.html">Registro y Depuración</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../text/index.html">Texto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../commands/index.html">Plugin Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../event/index.html">Eventos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../configuration/index.html">Configurando Extensiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../assets.html">La API de Activos</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">La API de Datos</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="index.html">Datos Personalizados</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">ManipuladoresDeDatos Personalizados</a></li>
<li class="toctree-l4"><a class="reference internal" href="dataholders.html">DataHolders Personalizados</a></li>
<li class="toctree-l4"><a class="reference internal" href="serialization.html">Serializando Datos Personalizados</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../catalog-types.html">Catalog Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="../keys.html">Utilización de Claves</a></li>
<li class="toctree-l3"><a class="reference internal" href="../datamanipulators.html">Manipuladores de Datos</a></li>
<li class="toctree-l3"><a class="reference internal" href="../transactions.html">Transacciones</a></li>
<li class="toctree-l3"><a class="reference internal" href="../serialization.html">Serialización de Datos</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../blocks/index.html">Bloques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../entities/index.html">Entidades</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../items/index.html">Articulos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../trade-offers.html">Ofertas de Intercambio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../effects.html">Efectos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../scheduler.html">Programador</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../services.html">Servicios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../database.html">Bases de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../permissions.html">Permisos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bans.html">Baneos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../metrics.html">Metrics Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../bookview.html">Vistas del Libro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../economy/index.html">Economía</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../wgen/index.html">Generación de Mundo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../manager.html">Administrador de Complementos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../game-profile-manager.html">Administrador de Perfiles del Juego</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../offline-userplayer-data.html">Datos del Jugador Fuera de Línea</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tab-lists.html">Listas de Tabulaciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../plugin-meta.html">Metadatos del Complemento</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../ray-tracing.html">Trazado de Rayos (Ray Tracing)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../debugging.html">Depuración de Complemento</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tutorials.html">Tutoriales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../internals/index.html">Implementation-dependent Plugins</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../ore/index.html">Documentación Ore</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../contributing/index.html">Contribuyendo a Sponge</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../about/index.html">Acerca del proyecto Sponge</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../../index.html">Sponge</a>
      </nav>


      <div class="wy-nav-content">
        <div class="rst-content">

 

<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../../index.html">Docs</a> &raquo;</li>
          <li><a href="../../index.html">Creando un Plugin</a> &raquo;</li>
          <li><a href="../index.html">La API de Datos</a> &raquo;</li>
          <li><a href="index.html">Datos Personalizados</a> &raquo;</li>
    <li>ManipuladoresDeDatos Personalizados</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/plugin/data/custom/datamanipulators.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
  <div class="section" id="custom-datamanipulators">
<h1>ManipuladoresDeDatos Personalizados<a class="headerlink" href="#custom-datamanipulators" title="Enlazar permanentemente con este título">¶</a></h1>
<p>La parte principal de los datos personalizados es <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/manipulator/DataManipulator.html">DataManipulator</a>. Para implementarlo, primero debes decidir si quieres crear una API separada para tus datos personalizados. Generalmente hablando es mejor separar la API de la implementación (como lo hace la API de Sponge), pero si no va a ser vista por otros desabolladores entonces puedes simplemente poner ambas en la misma clase.</p>
<p>You’ll want to define an API method for each «unit» your data, such as a <code class="docutils literal notranslate"><span class="pre">String</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/item/inventory/ItemStack.html">ItemStack</a> or
a custom type like <code class="docutils literal notranslate"><span class="pre">Home</span></code>. These units will be wrapped in a <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/value/mutable/Value.html">Value</a>, which will allow it to be accessed
with <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/key/Key.html">Key</a>s. There are various extensions of <code class="docutils literal notranslate"><span class="pre">Value</span></code> depending on which object will be represented, such
as <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/value/mutable/MapValue.html">MapValue</a> which provides the standard map operations, or <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/value/mutable/MutableBoundedValue.html">MutableBoundedValue</a> which can set
limits on the upper and lower bound of the value (like integers). The bounds of the values are verified using a
<a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html">Comparator</a>.</p>
<p>Ahora, elige de cual de los tipos de <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/manipulator/mutable/common/AbstractData.html">AbstractData</a> extenderás. Aunque podrias implementar desde cero, estos tipos de abstracto quitan <em>mucho</em> del trabajo que necesita hacerse implementando los métodos requeridos. Una lista completa puede ser encontrada en <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/manipulator/mutable/common/package-summary.html">org.spongepowered.api.data.manipulator.mutable.common</a>. Ve también <a class="reference internal" href="#single-data-types"><span class="std std-ref">Tipos Únicos</span></a> or <a class="reference internal" href="#compound-data-types"><span class="std std-ref">Tipos Compuestos</span></a> a continuación para detalles de implementación de cada tipo.</p>
<p>Debes crear dos clases diferentes - una que es alterable e implementa <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/manipulator/DataManipulator.html">DataManipulator</a> y tu tipo de abstracto, y una versión inalterable que implementa <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/manipulator/ImmutableDataManipulator.html">ImmutableDataManipulator</a> y tu tipo de abstracto <em>inmutable</em>.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last"><strong>Todos</strong> los datos deben tener versiones mutables e inmutables, debes implementar ambas.</p>
</div>
<p>Para todos los tipos, necesitaras definir los metodos <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/manipulator/DataManipulator.html#asImmutable--">DataManipulator#asImmutable()</a>/ <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/manipulator/ImmutableDataManipulator.html#asMutable--">asMutable()</a> - esto es tan simple como copiar los objetos existentes a constructores para las versiones alternativas.</p>
<div class="section" id="values">
<h2>Valores<a class="headerlink" href="#values" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Tu(s) getter(s) de valor deben devolver un valor. En el ejemplo a continuación, obtenemos el <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/value/ValueFactory.html">ValueFactory</a>. Esto nos ahorra un montón de tipeo al usar los objetos <code class="docutils literal notranslate"><span class="pre">Value</span></code> ya implementados de Sponge. Dependiendo de que valor estes creando hay diferentes metodos que llamar tales como <code class="docutils literal notranslate"><span class="pre">createMapValue</span></code>, <code class="docutils literal notranslate"><span class="pre">createBoundedComparableValue</span></code>, etc.</p>
<p><strong>Ejemplo de Código: Implementando un Getter de Valor</strong></p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.Sponge</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.data.value.ValueFactory</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.data.value.mutable.Value</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.spongepowered.cookbook.myhomes.data.home.Home</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.cookbook.myhomes.data.Keys</span><span class="p">;</span>

<span class="nd">@Override</span>
<span class="kd">protected</span> <span class="n">Value</span><span class="o">&lt;</span><span class="n">Home</span><span class="o">&gt;</span> <span class="nf">defaultHome</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">Sponge</span><span class="p">.</span><span class="na">getRegistry</span><span class="p">().</span><span class="na">getValueFactory</span><span class="p">()</span>
            <span class="p">.</span><span class="na">createValue</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="na">DEFAULT_HOME</span><span class="p">,</span> <span class="n">getValue</span><span class="p">(),</span> <span class="kc">null</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Nota que un <code class="docutils literal notranslate"><span class="pre">ImmutableDataManipulator</span></code> devolvería en su lugar un <code class="docutils literal notranslate"><span class="pre">ImmutableValue</span></code>, al llamar <code class="docutils literal notranslate"><span class="pre">asImmutable()</span></code> en el <code class="docutils literal notranslate"><span class="pre">Value</span></code> devuelto. Recomendamos que cachees esto (al igual que con una campo de clase) en la versión inmutable.</p>
<p>Cada <code class="docutils literal notranslate"><span class="pre">Value</span></code> también necesita un <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/key/Key.html">Key</a> para identificarlo, visto en el siguiente ejemplo como <code class="docutils literal notranslate"><span class="pre">Keys.DEFAULT_HOME</span></code>. Similar a los valores, usas uno de los métodos <code class="docutils literal notranslate"><span class="pre">makeXKey()</span></code> en <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/key/KeyFactory.html">KeyFactory</a> para crear un <code class="docutils literal notranslate"><span class="pre">Key</span></code> para tu valor.</p>
<p>Necesitar pasar un <code class="docutils literal notranslate"><span class="pre">TypeToken</span></code> representando el tipo <em>puro</em> de tu valor, y un <code class="docutils literal notranslate"><span class="pre">TypeToken</span></code> representando el <code class="docutils literal notranslate"><span class="pre">Value</span></code>. También necesitas proporcionar una ruta <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/DataQuery.html">DataQuery</a> - esto es mas comúnmente usado para serializar el <code class="docutils literal notranslate"><span class="pre">Value</span></code>. Al igual que con cualquier tipo de catalogo debes también proporcionar un ID y nombre únicos. Reúne todo esto y tendrás un <code class="docutils literal notranslate"><span class="pre">Key</span></code> que pudes usar en tus <code class="docutils literal notranslate"><span class="pre">Value</span></code>s.</p>
<p><strong>Ejemplo de Código: Creando una Clave</strong></p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.data.DataQuery</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.data.key.Key</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.data.key.KeyFactory</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.data.value.mutable.Value</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.data.value.mutable.Value</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.google.common.reflect.TypeToken</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.spongepowered.cookbook.myhomes.data.home.Home</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">static</span> <span class="kd">final</span> <span class="n">Key</span><span class="o">&lt;</span><span class="n">Value</span><span class="o">&lt;</span><span class="n">Home</span><span class="o">&gt;&gt;</span> <span class="n">DEFAULT_HOME</span> <span class="o">=</span> <span class="n">KeyFactory</span><span class="p">.</span><span class="na">makeSingleKey</span><span class="p">(</span>
        <span class="n">TypeToken</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">Home</span><span class="p">.</span><span class="na">class</span><span class="p">),</span>
        <span class="k">new</span> <span class="n">TypeToken</span><span class="o">&lt;</span><span class="n">Value</span><span class="o">&lt;</span><span class="n">Home</span><span class="o">&gt;&gt;</span><span class="p">()</span> <span class="p">{},</span>
        <span class="n">DataQuery</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;DefaultHome&quot;</span><span class="p">),</span> <span class="s">&quot;myhomes:default_home&quot;</span><span class="p">,</span> <span class="s">&quot;Default Home&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p>Los <a class="reference external" href="https://guava.dev/releases/21.0/api/docs/com/google/common/reflect/TypeToken.html">TypeToken</a>s son usados por la implementación para conservar el tipo genérico de tus valores. Sponge proporciona una larga lista de símbolos pre-construidos para la API en <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/util/TypeTokens.html">TypeTokens</a>.</p>
<p>Si necesitas crear el tuyo propio, puedes hacerlo de dos maneras:</p>
<ul class="last simple">
<li>Para tipos no genéricos, utiliza <code class="docutils literal notranslate"><span class="pre">TypeToken.of(MyType.class)</span></code></li>
<li>Para tipos genéricos, crea una clase anónima con <code class="docutils literal notranslate"><span class="pre">TypeToken&lt;MyGenericType&lt;String&gt;&gt;()</span> <span class="pre">{}</span></code></li>
</ul>
</div>
</div>
<div class="section" id="serialization">
<h2>Serialización<a class="headerlink" href="#serialization" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Para hacer sus datos <span class="xref std std-doc">serializable &lt;../serialization&gt;`a :javadoc:`DataHolder</span>s o archivos de configuración, Ud debería también implementar <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/DataSerializable.html#toContainer--">DataSerializable#toContainer()</a>.Nosotros recomendamos llamar a``super.toContainer()``ya que este incluirá la versión de <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/DataSerializable.html#getContentVersion--">DataSerializable#getContentVersion()</a>. Usted debería incrementar la versión cada vez que se hace un cambio al formato de los datos serializados, y usar :ref:<a href="#id1"><span class="problematic" id="id2">`</span></a>content-updaters`para permitir la compatibilidad con las versiones anteriores.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Esto no es requerido para tipos únicos simples, ya que ya implementan <code class="docutils literal notranslate"><span class="pre">toContainer()</span></code></p>
</div>
<p><strong>Ejemplo de Código: Implementando toContainer</strong></p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.data.DataContainer</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.spongepowered.cookbook.myhomes.data.Keys</span><span class="p">;</span>

<span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">DataContainer</span> <span class="nf">toContainer</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">DataContainer</span> <span class="n">container</span> <span class="o">=</span> <span class="kd">super</span><span class="p">.</span><span class="na">toContainer</span><span class="p">();</span>
    <span class="c1">// This is the simplest, but use whatever structure you want!</span>
    <span class="n">container</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="na">DEFAULT_HOME</span><span class="p">.</span><span class="na">getQuery</span><span class="p">(),</span> <span class="k">this</span><span class="p">.</span><span class="na">defaultHome</span><span class="p">);</span>
    <span class="n">container</span><span class="p">.</span><span class="na">set</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="na">HOMES</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="na">homes</span><span class="p">);</span>

    <span class="k">return</span> <span class="n">container</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="registration">
<h2>Registro<a class="headerlink" href="#registration" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Registrando tu <code class="docutils literal notranslate"><span class="pre">DataManipulator</span></code> permite que sea accesible por Sponge y por otras extensiones en una forma generica. El juego/extensión puede crear copias de tus datos y serializar/deserializar tus datos sin referenciar ninguna de tus clases directamente.</p>
<p>Para registrar un <code class="docutils literal notranslate"><span class="pre">DataManipulator</span></code> Sponge tiene la guía <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/DataRegistration.html#builder--">DataRegistration#builder()</a>. Esto construirá un <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/DataRegistration.html">DataRegistration</a> y lo registrará automáticamente.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Debido a la naturaleza de los datos, <em>debs</em> registrar tu``DataManipulator`` durante la inicialización - generalmente escuchando a :javadoc: “GameInitializationEvent” tal como en el ejemplo siguiente. Si intentas registrar un <code class="docutils literal notranslate"><span class="pre">DataManipulator</span></code> una vez completada la inicialización se producirá una excepción.</p>
</div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.event.game.state.GameInitializationEvent</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.data.DataRegistration</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.example.MyCustomData</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.example.ImmutableCustomData</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.example.CustomDataBuilder</span><span class="p">;</span>

<span class="nd">@Listener</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">onInit</span><span class="p">(</span><span class="n">GameInitializationEvent</span> <span class="n">event</span><span class="p">)</span> <span class="p">{</span>
  <span class="n">DataRegistration</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
      <span class="p">.</span><span class="na">dataClass</span><span class="p">(</span><span class="n">MyCustomData</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
      <span class="p">.</span><span class="na">immutableClass</span><span class="p">(</span><span class="n">ImmutableCustomData</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
      <span class="p">.</span><span class="na">builder</span><span class="p">(</span><span class="k">new</span> <span class="n">CustomDataBuilder</span><span class="p">())</span>
      <span class="p">.</span><span class="na">manipulatorId</span><span class="p">(</span><span class="s">&quot;my-custom&quot;</span><span class="p">)</span>
      <span class="p">.</span><span class="na">dataName</span><span class="p">(</span><span class="s">&quot;My Custom&quot;</span><span class="p">)</span>
      <span class="p">.</span><span class="na">build</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Advertencia</p>
<p class="last">Data that was serialized prior to <code class="docutils literal notranslate"><span class="pre">6.0.0</span></code>, or data where you have changed the ID, will <em>not</em> be recognized unless
registered with <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/DataManager.html#registerLegacyManipulatorIds-java.lang.String-org.spongepowered.api.data.DataRegistration-">DataManager#registerLegacyManipulatorIds(String, DataRegistration)</a>. If registering a
pre-6.0.0 <code class="docutils literal notranslate"><span class="pre">DataManipulator</span></code> the ID is taken from <cite>Class.getName()</cite>, such as <code class="docutils literal notranslate"><span class="pre">com.example.MyCustomData</span></code>.</p>
</div>
</div>
<div class="section" id="single-types">
<span id="single-data-types"></span><h2>Tipos Únicos<a class="headerlink" href="#single-types" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Single types require little implementation because much of the work has already been done in the
<a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/manipulator/mutable/common/AbstractSingleData.html">AbstractSingleData</a> type you extend from.</p>
<p>Los tipos de abstractos «simples» son los mas fáciles de implementas, pero se limitan solo a los siguientes tipos:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">Boolean</span></code></li>
<li><a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/Comparable.html">Comparable</a></li>
<li><code class="docutils literal notranslate"><span class="pre">Integer</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">List</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Map</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">CatalogType</span></code></li>
<li><code class="docutils literal notranslate"><span class="pre">Enum</span></code></li>
</ul>
<p>Para todos los otros tipos debes implementar un tipo único personalizado extendiendo <code class="docutils literal notranslate"><span class="pre">AbstractSingleData</span></code>. Esto te permite definir tus propios datos con cualquier tipo que quieras, mientras sigue haciendo la mayor parte del trabajo por ti.</p>
<div class="admonition tip">
<p class="first admonition-title">Truco</p>
<p class="last">Las implementaciones abstractas guardan el objeto para ti en el constructor. Puedes acceder a él en su ejecución llamando a los métodos <code class="docutils literal notranslate"><span class="pre">getValue()</span></code> and <code class="docutils literal notranslate"><span class="pre">getValueGetter()</span></code>.</p>
</div>
<div class="section" id="simple-single-types">
<h3>Tipos Únicos Simples<a class="headerlink" href="#simple-single-types" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Casi todo el trabajo es hecho por ti con tipos abstractos simples. Todo lo que necesitas hacer es:</p>
<ul class="simple">
<li>Extiende el tipo abstracto relevante</li>
<li>pasa la <cite>Key</cite> para tus datos, el objeto en si mismo, y el objeto por defecto (si el objeto es nulo) en el constructor</li>
</ul>
<p><a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/manipulator/mutable/common/AbstractBoundedComparableData.html">AbstractBoundedComparableData</a> (y el equivalente inmutable) adicionalmente requiere valores mínimos y máximos que serán comprobados, al igual que un <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/util/Comparator.html">Comparator</a>.</p>
<div class="admonition note">
<p class="first admonition-title">Nota</p>
<p class="last">Los tipos simples <code class="docutils literal notranslate"><span class="pre">List</span></code> y <code class="docutils literal notranslate"><span class="pre">Mapped</span></code> deben implementar en su lugar <code class="docutils literal notranslate"><span class="pre">ListData</span></code> / <code class="docutils literal notranslate"><span class="pre">MappedData``(o</span> <span class="pre">el</span> <span class="pre">equivalente</span> <span class="pre">inmutable).</span> <span class="pre">Esto</span> <span class="pre">añade</span> <span class="pre">métodos</span> <span class="pre">adicionales</span> <span class="pre">para</span> <span class="pre">permitir</span> <span class="pre">el</span> <span class="pre">comportamiento</span> <span class="pre">similar</span> <span class="pre">a</span> <span class="pre">Mapa/Lista</span> <span class="pre">directamente</span> <span class="pre">en</span> <span class="pre">el</span> <span class="pre">``DataManipulator</span></code>.</p>
</div>
<p>The following 3 methods must be defined on mutable manipulators:</p>
<p><code class="docutils literal notranslate"><span class="pre">fill(DataHolder,</span> <span class="pre">MergeFunction)</span></code> deberia remplazar los datos en tu objeto con ese del <code class="docutils literal notranslate"><span class="pre">DataHolder</span></code> dado, usando el resultado de <code class="docutils literal notranslate"><span class="pre">MergeFunction#merge()</span></code>.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.data.DataHolder</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.data.merge.MergeFunction</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.spongepowered.cookbook.myhomes.data.friends.FriendsData</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Optional</span><span class="p">;</span>

<span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">Optional</span><span class="o">&lt;</span><span class="n">FriendsData</span><span class="o">&gt;</span> <span class="nf">fill</span><span class="p">(</span><span class="n">DataHolder</span> <span class="n">dataHolder</span><span class="p">,</span> <span class="n">MergeFunction</span> <span class="n">overlap</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">FriendsData</span> <span class="n">merged</span> <span class="o">=</span> <span class="n">overlap</span><span class="p">.</span><span class="na">merge</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">dataHolder</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">FriendsData</span><span class="p">.</span><span class="na">class</span><span class="p">).</span><span class="na">orElse</span><span class="p">(</span><span class="kc">null</span><span class="p">));</span>
    <span class="n">setValue</span><span class="p">(</span><span class="n">merged</span><span class="p">.</span><span class="na">friends</span><span class="p">().</span><span class="na">get</span><span class="p">());</span>

    <span class="k">return</span> <span class="n">Optional</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="k">this</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">from(DataContainer)</span></code> debería sobrescribir su valor con el del contenedor y devolverse a si mismo, de otra forma devolver <code class="docutils literal notranslate"><span class="pre">Optional.empty()</span></code></p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.data.DataContainer</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.data.DataQuery</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">org.spongepowered.cookbook.myhomes.data.Keys</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.cookbook.myhomes.data.friends.FriendsData</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.cookbook.myhomes.data.friends.ImmutableFriendsData</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">com.google.common.collect.Maps</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Optional</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.UUID</span><span class="p">;</span>

<span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">Optional</span><span class="o">&lt;</span><span class="n">FriendsData</span><span class="o">&gt;</span> <span class="nf">from</span><span class="p">(</span><span class="n">DataContainer</span> <span class="n">container</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span><span class="p">(</span><span class="n">container</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="na">FRIENDS</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">List</span><span class="o">&lt;</span><span class="n">UUID</span><span class="o">&gt;</span> <span class="n">friends</span> <span class="o">=</span> <span class="n">container</span><span class="p">.</span><span class="na">getObjectList</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="na">FRIENDS</span><span class="p">.</span><span class="na">getQuery</span><span class="p">(),</span> <span class="n">UUID</span><span class="p">.</span><span class="na">class</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>
        <span class="k">return</span> <span class="n">Optional</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">setValue</span><span class="p">(</span><span class="n">friends</span><span class="p">));</span>
    <span class="p">}</span>

    <span class="k">return</span> <span class="n">Optional</span><span class="p">.</span><span class="na">empty</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">copy()</span></code> deberia, como el nombre sugiere, devolver una copia de si mismo con los mismos datos.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.cookbook.myhomes.data.friends.FriendsData</span><span class="p">;</span>

<span class="nd">@Override</span>
<span class="kd">public</span> <span class="n">FriendsData</span> <span class="nf">copy</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="n">FriendsDataImpl</span><span class="p">(</span><span class="n">getValue</span><span class="p">());</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-single-types">
<h3>Tipos Unicos Personalizados<a class="headerlink" href="#custom-single-types" title="Enlazar permanentemente con este título">¶</a></h3>
<p>In addition to the methods from the simple single types, you need to override the following methods:</p>
<p><code class="docutils literal notranslate"><span class="pre">getValueGetter()</span></code> deberia pasar el <code class="docutils literal notranslate"><span class="pre">Value</span></code> representando tus datos (ver arriba).</p>
<p><code class="docutils literal notranslate"><span class="pre">toContainer()</span></code> deberia devolver un <code class="docutils literal notranslate"><span class="pre">DataContainer</span></code> representando tus datos (see above).</p>
</div>
</div>
<div class="section" id="compound-types">
<span id="compound-data-types"></span><h2>Tipos Compuestos<a class="headerlink" href="#compound-types" title="Enlazar permanentemente con este título">¶</a></h2>
<p>Mientras que los tipos únicos admiten sólo un valor, los tipos «compuesto» soportan cuantos valores quieras. Esto es útil cuando se agrupan varios objetos, tales como :javadoc: “FurnaceData”. El lado negativo, sin embargo, es que son más complejos de implementar.</p>
<p>Para comenzar, cree todos los getters “Valor” que tendrá la información. Para cada valor, cree un método para acceder y configurar el objeto <em>en crudo</em>, el cual será usado luego. Para los datos que sean invariables, solamente se necesitarán los getters.</p>
<div class="section" id="registering-values">
<h3>Registrando Valores<a class="headerlink" href="#registering-values" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Next, you’ll want to register these so that the <a class="reference internal" href="../keys.html"><span class="doc">Keys</span></a>-based system can reference them. To do this,
implement either <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/manipulator/mutable/common/AbstractData.html#registerGettersAndSetters--">AbstractData#registerGettersAndSetters()</a> or
<a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/data/manipulator/immutable/common/AbstractImmutableData.html#registerGetters--">AbstractImmutableData#registerGetters()</a> depending on whether the data is mutable or not.</p>
<p>Para cada valor debes llamar:</p>
<ul class="simple">
<li><code class="docutils literal notranslate"><span class="pre">registerKeyValue(Key,</span> <span class="pre">Supplier)</span></code> referenciando el getter de <a href="#id1"><span class="problematic" id="id2">``</span></a>Value` para la clave dada</li>
<li><code class="docutils literal notranslate"><span class="pre">registerFieldGetter(Key,</span> <span class="pre">Supplier)</span></code> haciendo referencia al método getter para el objeto <em>sin procesar</em> definido anteriormente</li>
<li><code class="docutils literal notranslate"><span class="pre">registerFieldSetter(Key,</span> <span class="pre">Consumer)</span></code> haciendo referencia al método setter anterior si está implementando la versión mutable</li>
</ul>
<p>Nosotros recomendamos usar las funciones Java 8´s <code class="docutils literal notranslate"><span class="pre">::</span></code> syntax for easy <code class="docutils literal notranslate"><span class="pre">Supplier</span></code> y <code class="docutils literal notranslate"><span class="pre">Consumer</span></code>.</p>
<p><strong>Ejemplo de Código: Implementando Getters y Setters</strong></p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.cookbook.myhomes.data.Keys</span>

<span class="c1">// registerGetters() for immutable implementation</span>
<span class="nd">@Override</span>
<span class="kd">protected</span> <span class="kt">void</span> <span class="nf">registerGettersAndSetters</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">registerKeyValue</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="na">DEFAULT_HOME</span><span class="p">,</span> <span class="k">this</span><span class="p">::</span><span class="n">defaultHome</span><span class="p">);</span>
    <span class="n">registerKeyValue</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="na">HOMES</span><span class="p">,</span> <span class="k">this</span><span class="p">::</span><span class="n">homes</span><span class="p">);</span>

    <span class="n">registerFieldGetter</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="na">DEFAULT_HOME</span><span class="p">,</span> <span class="k">this</span><span class="p">::</span><span class="n">getDefaultHome</span><span class="p">);</span>
    <span class="n">registerFieldGetter</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="na">HOMES</span><span class="p">,</span> <span class="k">this</span><span class="p">::</span><span class="n">getHomes</span><span class="p">);</span>

    <span class="c1">// Only on mutable implementation</span>
    <span class="n">registerFieldSetter</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="na">DEFAULT_HOME</span><span class="p">,</span> <span class="k">this</span><span class="p">::</span><span class="n">setDefaultHome</span><span class="p">);</span>
    <span class="n">registerFieldSetter</span><span class="p">(</span><span class="n">Keys</span><span class="p">.</span><span class="na">HOMES</span><span class="p">,</span> <span class="k">this</span><span class="p">::</span><span class="n">setHomes</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">fill(DataHolder,</span> <span class="pre">MergeFunction)</span></code> y <code class="docutils literal notranslate"><span class="pre">from(DataContainer)</span></code> son similares a las implementaciones para datos individuales, pero cargando todos tu valores.</p>
</div>
</div>
</div>

           </div>
          </div>
<footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="dataholders.html" class="btn btn-neutral float-right" title="DataHolders Personalizados" accesskey="n" rel="next">Siguiente <span class="fa fa-angle-right"></span></a>
        <a href="index.html" class="btn btn-neutral" title="Datos Personalizados" accesskey="p" rel="prev"><span class="fa fa-angle-left"></span> Previo</a>
    </div>

    <hr/>

    <section id="license-footer">
        <p>Except where otherwise noted,
            <a xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" property="dct:title" rel="cc:attributionURL" href="https://github.com/SpongePowered/SpongeDocs">SpongeDocs</a>
            is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
        </p>
        <a id="license-icons" rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" title="CC-BY-SA" aria-hidden="true">cba</a>
    </section>
</footer>        </div>
      </div>

    </section>

  </div>


<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <i class="fa fa-book"> <span>SpongeDocs</span></i>
        v: 7.2.0
    <img src="../../../_static/flags/es_ES.svg"
         alt="es" title="Español">
        <span class="fa fa-caret-down"></span>
    </span>
    <div id="versions" class="rst-other-versions">




    </div>
</div>

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../../',
            VERSION:'7.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>      <script type="text/javascript" src="../../../_static/jquery.js"></script>      <script type="text/javascript" src="../../../_static/underscore.js"></script>      <script type="text/javascript" src="../../../_static/doctools.js"></script>      <script type="text/javascript" src="../../../_static/language_data.js"></script>      <script type="text/javascript" src="../../../_static/translations.js"></script>      <script type="text/javascript" src="../../../_static/spongedocs.js"></script>

    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
 
</body>
</html>