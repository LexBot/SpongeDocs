
<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Optionals erklärt &mdash; Sponge 7.2.0 Dokumentation</title>

    <link rel="shortcut icon" href="../../_static/favicon.ico"/>




    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

    <link rel="stylesheet" href="../../_static/spongedocs.css" type="text/css" />

        <link rel="index" title="Stichwortverzeichnis"
              href="../../genindex.html"/>        <link rel="search" title="Suche" href="../../search.html"/>    <link rel="top" title="Sponge 7.2.0 Dokumentation" href="../../index.html"/>        <link rel="up" title="Optionals" href="index.html"/>        <link rel="next" title="Beispiele für die Verwendung" href="usage.html"/>        <link rel="prev" title="Optionals" href="index.html"/>
    <!-- Google Analytics -->
    <script>
        (function(S,p,o,n,g,i,e){S['GoogleAnalyticsObject']=g;S[g]=S[g]||function(){
        (S[g].q=S[g].q||[]).push(arguments)},S[g].l=1*new Date();i=p.createElement(o),
        e=p.getElementsByTagName(o)[0];i.async=1;i.src=n;e.parentNode.insertBefore(i,e)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-59476017-2', 'auto');
        ga('send', 'pageview');
    </script>

  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
    <div id="sp-logo-container" class="page-scroll">
        <a class="logo" href="../../index.html">
            <img src="../../_static/spongie-mark-dark.svg">
            <span>Sponge</span>
            <i class="fa fa-fw fa-chevron-down"></i>
        </a>
        <div id="sp-logo-menu">
            <ul id="sp-logo-dropdown">
                <li><a href="https://www.spongepowered.org"><i class="fa-fw fa fa-home"></i>Homepage</a></li>
                <li><a href="https://forums.spongepowered.org"><i class="fa-fw fa fa-comments"></i>Forums</a></li>
                <li><a href="https://github.com/SpongePowered"><i class="fa-fw fa fa-code"></i>Code</a></li>
                <li class="active"><a href="https://docs.spongepowered.org"><i class="fa-fw fa fa-book"></i>Docs</a></li>
                <li><a href="https://jd.spongepowered.org"><i class="fa-fw fa fa-graduation-cap"></i>Javadocs</a></li>
                <li><a href="https://forums.spongepowered.org/c/plugins/plugin-releases"><i class="fa-fw fa fa-plug"></i>Plugins</a></li>
                <li><a href="https://ore.spongepowered.org"><img src="../../_static/ore.svg" alt="" class="fa-fw fa ore-logo">Ore <sup>Beta</sup></a></li>
                <li><a href="https://www.spongepowered.org/downloads"><i class="fa-fw fa fa-download"></i>Downloads</a></li>
                <li><a href="https://www.spongepowered.org/chat"><i class="fa-fw fa fa-comment"></i>Chat</a></li>
            </ul>
        </div>
    </div>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../server/index.html">Einen Server erstellen</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../versions/index.html">Versionsrichtlinie</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../preparing/index.html">Die Arbeitsumgebung einrichten</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Plugins erstellen</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api-versions.html">API-Versionen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../buildsystem.html">Build Systeme</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workspace/index.html">Den Arbeitsbereich einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project/index.html">Das Projekt einrichten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-identifier.html">Plugin Identifiers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-class.html">Hauptklasse des Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lifecycle.html">Der Plugin-Lebenszyklus</a></li>
<li class="toctree-l2"><a class="reference internal" href="../injection.html">Dependency Injection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practices/index.html">Vorgehensweisen</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Optionals</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Optionals erklärt</a></li>
<li class="toctree-l3"><a class="reference internal" href="usage.html">Beispiele für die Verwendung</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../logging.html">Loggen und Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../text/index.html">Text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/index.html">Plugin Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../event/index.html">Events</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/index.html">Plugins konfigurieren</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assets.html">Die Dateianhang API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html">The Data API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blocks/index.html">Blöcke</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entities/index.html">Entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="../items/index.html">Gegenstände</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trade-offers.html">Trade-Offers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../effects.html">Effekte</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduler.html">Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services.html">Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database.html">Datenbanken</a></li>
<li class="toctree-l2"><a class="reference internal" href="../permissions.html">Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bans.html">Banne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html">Metrics Collection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bookview.html">Bücher</a></li>
<li class="toctree-l2"><a class="reference internal" href="../economy/index.html">Wirtschaft</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wgen/index.html">Weltgenerierung</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manager.html">Plugin-Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../game-profile-manager.html">Game Profile Manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="../offline-userplayer-data.html">Offline Player Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tab-lists.html">Tab Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-meta.html">Plugin Metadaten</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ray-tracing.html">Ray Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging.html">Plugins Debuggen</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/index.html">Implementation-dependent Plugins</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ore/index.html">Ore Dokumentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Zu Sponge beitragen</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">Über das Sponge Projekt</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Sponge</a>
      </nav>


      <div class="wy-nav-content">
        <div class="rst-content">

 

<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
          <li><a href="../index.html">Plugins erstellen</a> &raquo;</li>
          <li><a href="index.html">Optionals</a> &raquo;</li>
    <li>Optionals erklärt</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/plugin/optional/basic.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
  <div class="section" id="optionals-explained">
<h1>Optionals erklärt<a class="headerlink" href="#optionals-explained" title="Link zu dieser Überschrift">¶</a></h1>
<p>Much of SpongeAPI makes use of Java’s <cite>Optional</cite> system on object accessors, but if you’ve never used <code class="docutils literal notranslate"><span class="pre">Optional</span></code>
before this might seem like a bit of a peculiar way of doing things. You might be tempted to ask:
<em>„why do I need to perform an extra step when fetching something from an API object?“</em></p>
<p>This section gives a brief summary of <code class="docutils literal notranslate"><span class="pre">Optional</span></code> and explains how - and perhaps more importantly why -
it’s used throughout SpongeAPI.</p>
<p>Wir beginnen mit einer kleinen Geschichte und schauen, wie Zugriffsmethoden - besonders Getter-Methoden - in der Regel arbeiten, wenn sie nicht <code class="docutils literal notranslate"><span class="pre">Optional</span></code> benutzen.</p>
<div class="section" id="implicit-nullable-contracts-and-why-they-suck">
<h2>1. Werte, welche NULL enthalten könnten - und warum sie nerven<a class="headerlink" href="#implicit-nullable-contracts-and-why-they-suck" title="Link zu dieser Überschrift">¶</a></h2>
<p>Gehen wir einmal davon aus, wir hätten ein einfaches API-Objekt mit dem Namen <code class="docutils literal notranslate"><span class="pre">Entity</span></code>, welches eine Methode namens <code class="docutils literal notranslate"><span class="pre">getFoo()</span></code> hat. Diese Methode übergibt eine <code class="docutils literal notranslate"><span class="pre">Foo</span></code>-Instanz.</p>
<img alt="../../_images/optionals1.png" src="../../_images/optionals1.png" />
<p>Früher hätte man vielleicht solch eine einfache Methode benutzt, um an sein Sandwich zu kommen:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">someEventHandler</span><span class="p">(</span><span class="n">Entity</span> <span class="n">someEntity</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Foo</span> <span class="n">entityFoo</span> <span class="o">=</span> <span class="n">someEntity</span><span class="p">.</span><span class="na">getFoo</span><span class="p">();</span>
    <span class="n">entityFoo</span><span class="p">.</span><span class="na">bar</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Das Problem entsteht dann, wenn es sich um Methoden handelt, welche nicht zwingend eine <code class="docutils literal notranslate"><span class="pre">Foo</span></code>-Instanz übergeben, sondern manchmal auch einfach nur <code class="docutils literal notranslate"><span class="pre">null</span></code>. Dass die entsprechende Methode eventuell <code class="docutils literal notranslate"><span class="pre">null</span></code> übergeben könnte, kann man auf verschiedene Weisen deklarieren:</p>
<ul class="simple">
<li><strong>In den Javadoc</strong> - Das ist deshalb eine schlechte Idee, weil es dann notwendig ist, dass der Plugin-Entwickler die Javadoc ließt. Dies ist aber nicht immer der Fall.</li>
<li><strong>Die Nutzung von Nullable-Annotiations</strong> - Das ist nicht ideal, da Annotations in der Regel ein Programm benötigen, von dem sie verarbeitet werden, beispielsweise eine IDE oder ein Compiler.</li>
</ul>
<img alt="../../_images/optionals2.png" src="../../_images/optionals2.png" />
<p>Nun nehmen wir an, unsere <code class="docutils literal notranslate"><span class="pre">getFoo()</span></code>-Methode wäre eine dieser Methoden, welche <code class="docutils literal notranslate"><span class="pre">null</span></code> übergeben könnten. Das würde bedeuten, dass unser Code von oben unsicher ist und eine <code class="docutils literal notranslate"><span class="pre">NullPointerException</span></code> entstehen könnte, sollte <code class="docutils literal notranslate"><span class="pre">entityFoo</span></code> <code class="docutils literal notranslate"><span class="pre">null</span></code> sein.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">someEventHandler</span><span class="p">(</span><span class="n">Entity</span> <span class="n">someEntity</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Foo</span> <span class="n">entityFoo</span> <span class="o">=</span> <span class="n">someEntity</span><span class="p">.</span><span class="na">getFoo</span><span class="p">();</span>
    <span class="n">entityFoo</span><span class="p">.</span><span class="na">bar</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Angenommen, unser Plugin-Entwickler weiß, dass die Methode <code class="docutils literal notranslate"><span class="pre">null</span></code> übergeben könnte. Er entscheidet sich dafür, das Problem zu umgehen, indem er nach der API-Abfrage überprüft, ob <code class="docutils literal notranslate"><span class="pre">entityFoo</span></code> eventuell <code class="docutils literal notranslate"><span class="pre">null</span></code> ist. Ist dies der Fall, dann ersetzt er den <code class="docutils literal notranslate"><span class="pre">null</span></code>-Wert durch eine <code class="docutils literal notranslate"><span class="pre">Foo</span></code>-Instanz, welche er in einer Konstanten speichert. Das Resultat würde so aussehen:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">someEventHandler</span><span class="p">(</span><span class="n">Entity</span> <span class="n">someEntity</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Foo</span> <span class="n">entityFoo</span> <span class="o">=</span> <span class="n">someEntity</span><span class="p">.</span><span class="na">getFoo</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">entityFoo</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">entityFoo</span> <span class="o">=</span> <span class="n">MyPlugin</span><span class="p">.</span><span class="na">DEFAULT_FOO</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">entityFoo</span><span class="p">.</span><span class="na">bar</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example, the plugin author is aware that the method can return null and has a constant available with a
default instance of <code class="docutils literal notranslate"><span class="pre">Foo</span></code> which can be used instead. Of course, the plugin could just short-circuit the call entirely,
or it could attempt to fetch <cite>Foo</cite> from somewhere else. The key message is that handling nulls even in simple cases
can lead to spaghetti code quite quickly, and moreover relies on the plugin author to explicitly visit the method’s
contract to check whether a null check is necessary in the first place.</p>
<p>Allerdings ist dies nicht der einzige Nachteil. Betrachten wir die API mal über einen längeren Zeitraum. Lass uns annehmen, dass der Autor des Plugins sich die Javadoc der Methode anschaut und sieht, dass diese garantiert unter keinen Umständen null zurückliefert ( da jede <cite>Entity</cite> immer auch ein <code class="docutils literal notranslate"><span class="pre">Foo</span></code> hat). Spitze! Keine aufgeblasenen null-Überprüfungen notwendig!</p>
<p>Aber nun lass uns annehmen, dass in einer späteren Version des Spieles die Entwickler des Spieles das Konzept von <code class="docutils literal notranslate"><span class="pre">Foo</span></code> entfernen oder überholen. Die Ersteller der API passen ihre API entsprechend an und sagen, dass von nun an die Methode <code class="docutils literal notranslate"><span class="pre">getFoo()</span></code> <code class="docutils literal notranslate"><span class="pre">null</span></code> zurückgeben kann und schreiben das auch so ins Javadoc. Nun darin liegt das Problem: Selbst wenn gewissenhafte Plugin Autoren die Methodenspezifikation überprüft haben, als sie den Code zum ersten Mal geschrieben haben, werden sie die Methode nun falsch behandeln: Ohne <code class="docutils literal notranslate"><span class="pre">null</span></code> Überprüfungen an Ort und Stelle wird jeder Code der versucht das von <code class="docutils literal notranslate"><span class="pre">getFoo</span></code> zurückgegebene <code class="docutils literal notranslate"><span class="pre">Foo</span></code> zu verwenden eine NPE verursachen.</p>
<p>Thus, we can see that allowing implicit nullable contracts leaves us with a selection of pretty awful solutions to
choose from:</p>
<ul class="simple">
<li>Die Autoren von Plugins können annehmen, dass <strong>alle</strong> Methoden null zurückgeben können und programmieren entsprechend defensiv, aber wir haben bereits gesehen, dass dies sehr schnell zu hässlichen Spaghetti Code führt.</li>
<li>Die Ersteller der API könnten definieren, dass jede Methode null zurückgeben kann, um das Problem mit der Null-Behandlung auf den Entwickler des Plugins abzuschieben, was das vorherige Problem nur verschlimmert.</li>
<li>Die Autoren der API können garantieren, dass keine Methode ihre Spezifikation bzgl. Null in Zukunft mehr ändert. Das bedeutet, dass im Falle der Entfernung eines Features vom Basis-Spiel sie eine der folgenden Möglichkeiten haben:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>Eine Exception werfen - was nicht wirklich elegant ist, aber immer noch deutlich einfacher zu diagnostizieren ist als eine eine freigelassene NPE irgendwo im Code, die nur sehr schwer zurückverfolgt werden kann</li>
<li>Ein „Fake“-Objekt oder eine ungültigen Wert zurückgeben - Das bedeutet, dass der weiterverarbeitende (Plugin) Code weiterhin funktionieren wird, aber es verursacht eine immer größer werdende Belastung für die API-Entwickler, die immer mehr Fake-Objekte erstellen müssen. Daraus könnte früher oder später eine Situation entstehen, dass große Teile der API mit Müll-Objekten gefüllt sind, die nur den Zweck erfüllen, die Teile der API zu unterstützen, die nicht länger verwendet werden können.</li>
</ul>
</div></blockquote>
<p>Nun sollte klar sein, dass es mit impliziten Null-erlaubenden Spezifikationen ein größeres Klumpen an Kopfschmerzen verbunden sind, die nur noch schlimmer werden, wenn die betroffene API selbst nur eine Schicht über eine ohnehin sehr instabiles Basis-Produkt ist. Glücklicherweise gibt es eine bessere Lösung:</p>
</div>
<div class="section" id="optional-and-the-explicit-nullable-contract">
<h2>2. Optional und die explizit Null-erlaubende Spezifikation<a class="headerlink" href="#optional-and-the-explicit-nullable-contract" title="Link zu dieser Überschrift">¶</a></h2>
<p>As mentioned above, APIs for Minecraft are in a difficult situation. Ultimately, they need to provide a platform with
a <em>reasonable amount of implied stability</em> atop a platform (the game) with <em>absolutely no amount of implied stability</em>.
Thus, any API for Minecraft needs to be designed with full awareness that any aspect of the game is liable to change at
any time for any reason in any way imaginable; up to and including being removed altogether!</p>
<p>Diese Dynamik führt zu den oben beschriebenen Problemen mit Null-erlaubenden Methoden Spezifikationen.</p>
<p><cite>Optional</cite> löst das zuvor genannte Problem, indem es die implizite Spezifikation durch eine explizite ersetzt. Die API wirbt niemals damit, <em>„Hier ist dein Objekt, Danke und Tschüss“</em>, sondern es präsentiert den Zugriff mit <em>„Hier ist eine Kiste, die das Objekt enthält, nach dem du gefragt hast, oder halt auch nicht“</em>.</p>
<img alt="../../_images/optionals3.png" src="../../_images/optionals3.png" />
<p>Durch das Verpacken der Möglichkeit <code class="docutils literal notranslate"><span class="pre">null</span></code> zurückzugeben in eine explizite Absprache, können wir das Konzept des <em>Null-Überprüfens</em> durch das leicht abgewandelte Konzept des <em>Könnte nicht vorhanden sein</em> ersetzten. Wir vereinbaren diese Absprache deshalb auch <em>vom ersten Tag an</em>.</p>
<p>So, what does this mean?</p>
<p>Um es auf den Punkt zu bringen, die Plugin Autoren müssen sich nicht länger darum kümmern, dass <code class="docutils literal notranslate"><span class="pre">null</span></code> zurückgegeben wird. Stattdessen wird die ganze Möglichkeit, dass ein spezifisches Objekt nicht vorhanden ist, durch die Struktur des Plugin Codes selbst ausgedrückt. Dies hat das selbe Maß ein eingebauter Sicherheit, wie das ständige Überprüfen auf Null und hat zudem den Vorteil, dass der Code dadurch deutlich eleganter und einfacher zu lesen wird.</p>
<p>Um dies zu zeigen, lasst uns einen Blick auf das Beispiel von oben werfen, allerdings mit der Änderung, dass die <code class="docutils literal notranslate"><span class="pre">getFoo</span></code> Methode jetzt ein <code class="docutils literal notranslate"><span class="pre">Optional&lt;Foo&gt;</span></code> zurückgibt:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">someEventHandler</span><span class="p">(</span><span class="n">Entity</span> <span class="n">someEntity</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Optional</span><span class="o">&lt;</span><span class="n">Foo</span><span class="o">&gt;</span> <span class="n">entityFoo</span> <span class="o">=</span> <span class="n">someEntity</span><span class="p">.</span><span class="na">getFoo</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">entityFoo</span><span class="p">.</span><span class="na">isPresent</span><span class="p">())</span> <span class="p">{</span>
        <span class="n">entityFoo</span><span class="p">.</span><span class="na">get</span><span class="p">().</span><span class="na">bar</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>You may note that this example looks very much like a standard null-check, however the use of <code class="docutils literal notranslate"><span class="pre">Optional</span></code> actually
carries a little more information in the same amount of code. For example, it is not necessary for someone reading
the above code to check the method contract, it is clear that the method may not return a value, and the handling
of the value’s absence is explicit and clear.</p>
<p>So what? Our explicit contract in this case results in basically the same amount of code as a null check - albeit
one that is contractually <em>enforced</em> by the getter. <em>„Whoop de do,“</em> you say, <em>„so what?“</em></p>
<p>Well the <cite>Optional</cite> boxing allows us to take some of the traditionally more awkward aspects of null-checking and
make them more elegant: consider the following code:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">someEventHandler</span><span class="p">(</span><span class="n">Entity</span> <span class="n">someEntity</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Foo</span> <span class="n">entityFoo</span> <span class="o">=</span> <span class="n">someEntity</span><span class="p">.</span><span class="na">getFoo</span><span class="p">().</span><span class="na">orElse</span><span class="p">(</span><span class="n">MyPlugin</span><span class="p">.</span><span class="na">DEFAULT_FOO</span><span class="p">);</span>
    <span class="n">entityFoo</span><span class="p">.</span><span class="na">bar</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Hold the phone! Did we just replace the tedious null-check-and-default-assignment from the example above with a
single line of code? Yes indeed we did. In fact, for simple use cases we can even dispense with the assignment:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">someEventHandler</span><span class="p">(</span><span class="n">Entity</span> <span class="n">someEntity</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">someEntity</span><span class="p">.</span><span class="na">getFoo</span><span class="p">().</span><span class="na">orElse</span><span class="p">(</span><span class="n">MyPlugin</span><span class="p">.</span><span class="na">DEFAULT_FOO</span><span class="p">).</span><span class="na">bar</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is perfectly safe provided that <code class="docutils literal notranslate"><span class="pre">MyPlugin.DEFAULT_FOO</span></code> is always available.</p>
<p>Consider the following example with two entities, using an implicit nullable contract we want to use <code class="docutils literal notranslate"><span class="pre">Foo</span></code> from the
first entity, or if not available use <code class="docutils literal notranslate"><span class="pre">Foo</span></code> from the second <code class="docutils literal notranslate"><span class="pre">entity</span></code>, and fall back on our default if neither is
available:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">someEventHandler</span><span class="p">(</span><span class="n">Entity</span> <span class="n">someEntity</span><span class="p">,</span> <span class="n">Entity</span> <span class="n">entity2</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">Foo</span> <span class="n">entityFoo</span> <span class="o">=</span> <span class="n">someEntity</span><span class="p">.</span><span class="na">getFoo</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">entityFoo</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">entityFoo</span> <span class="o">=</span> <span class="n">entity2</span><span class="p">.</span><span class="na">getFoo</span><span class="p">();</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">entityFoo</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">entityFoo</span> <span class="o">=</span> <span class="n">MyPlugin</span><span class="p">.</span><span class="na">DEFAULT_FOO</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">entityFoo</span><span class="p">.</span><span class="na">bar</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">Optional</span></code> we can encode this much much more cleanly as:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">someEventHandler</span><span class="p">(</span><span class="n">Entity</span> <span class="n">someEntity</span><span class="p">,</span> <span class="n">Entity</span> <span class="n">entity2</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">someEntity</span><span class="p">.</span><span class="na">getFoo</span><span class="p">().</span><span class="na">orElse</span><span class="p">(</span><span class="n">entity2</span><span class="p">.</span><span class="na">getFoo</span><span class="p">().</span><span class="na">orElse</span><span class="p">(</span><span class="n">MyPlugin</span><span class="p">.</span><span class="na">DEFAULT_FOO</span><span class="p">)).</span><span class="na">bar</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is merely the tip of the <code class="docutils literal notranslate"><span class="pre">Optional</span></code> iceberg. In java 8 <code class="docutils literal notranslate"><span class="pre">Optional</span></code> also supports the <code class="docutils literal notranslate"><span class="pre">Consumer</span></code> and
<code class="docutils literal notranslate"><span class="pre">Supplier</span></code> interfaces, allowing lambdas to be used for <em>absent</em> failover. Usage examples for those can be found on the
<a class="reference internal" href="usage.html"><span class="doc">Beispiele für die Verwendung</span></a> page.</p>
<div class="admonition note">
<p class="first admonition-title">Bemerkung</p>
<p class="last">Another explanation on the rationale behind avoiding null references can be found on
<a class="reference external" href="https://github.com/google/guava/wiki/UsingAndAvoidingNullExplained/">Guava: Using And Avoiding Null Explained</a>.
Beware that the guava <code class="docutils literal notranslate"><span class="pre">Optional</span></code> class mentioned in the linked article is different from java’s
<code class="docutils literal notranslate"><span class="pre">java.util.Optional</span></code> and therefore will have method names different from those used here.</p>
</div>
</div>
</div>

           </div>
          </div>
<footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="usage.html" class="btn btn-neutral float-right" title="Beispiele für die Verwendung" accesskey="n" rel="next">Nächste <span class="fa fa-angle-right"></span></a>
        <a href="index.html" class="btn btn-neutral" title="Optionals" accesskey="p" rel="prev"><span class="fa fa-angle-left"></span> Vorherige</a>
    </div>

    <hr/>

    <section id="license-footer">
        <p>Except where otherwise noted,
            <a xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" property="dct:title" rel="cc:attributionURL" href="https://github.com/SpongePowered/SpongeDocs">SpongeDocs</a>
            is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
        </p>
        <a id="license-icons" rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" title="CC-BY-SA" aria-hidden="true">cba</a>
    </section>
</footer>        </div>
      </div>

    </section>

  </div>


<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <i class="fa fa-book"> <span>SpongeDocs</span></i>
        v: 7.2.0
    <img src="../../_static/flags/de_DE.svg"
         alt="de" title="Deutsch">
        <span class="fa fa-caret-down"></span>
    </span>
    <div id="versions" class="rst-other-versions">




    </div>
</div>

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'7.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>      <script type="text/javascript" src="../../_static/jquery.js"></script>      <script type="text/javascript" src="../../_static/underscore.js"></script>      <script type="text/javascript" src="../../_static/doctools.js"></script>      <script type="text/javascript" src="../../_static/language_data.js"></script>      <script type="text/javascript" src="../../_static/translations.js"></script>      <script type="text/javascript" src="../../_static/spongedocs.js"></script>

    <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
 
</body>
</html>