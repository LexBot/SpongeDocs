
<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>引數剖析 &mdash; Sponge 7.2.0 說明文件</title>

    <link rel="shortcut icon" href="../../_static/favicon.ico"/>




    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

    <link rel="stylesheet" href="../../_static/spongedocs.css" type="text/css" />

        <link rel="index" title="索引"
              href="../../genindex.html"/>        <link rel="search" title="搜尋" href="../../search.html"/>    <link rel="top" title="Sponge 7.2.0 說明文件" href="../../index.html"/>        <link rel="up" title="插件指令" href="index.html"/>        <link rel="next" title="指令旗標" href="flags.html"/>        <link rel="prev" title="建立一個指令" href="creating.html"/>
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
    <div id="sp-logo-container" class="page-scroll">
        <a class="logo" href="../../index.html">
            <img src="../../_static/spongie-mark-dark.svg">
            <span>Sponge</span>
            <i class="fa fa-fw fa-chevron-down"></i>
        </a>
        <div id="sp-logo-menu">
            <ul id="sp-logo-dropdown">
                <li><a href="https://www.spongepowered.org"><i class="fa-fw fa fa-home"></i>Homepage</a></li>
                <li><a href="https://forums.spongepowered.org"><i class="fa-fw fa fa-comments"></i>Forums</a></li>
                <li><a href="https://github.com/SpongePowered"><i class="fa-fw fa fa-code"></i>Code</a></li>
                <li class="active"><a href="https://docs.spongepowered.org"><i class="fa-fw fa fa-book"></i>Docs</a></li>
                <li><a href="https://jd.spongepowered.org"><i class="fa-fw fa fa-graduation-cap"></i>Javadocs</a></li>
                <li><a href="https://forums.spongepowered.org/c/plugins/plugin-releases"><i class="fa-fw fa fa-plug"></i>Plugins</a></li>
                <li><a href="https://ore.spongepowered.org"><img src="../../_static/ore.svg" alt="" class="fa-fw fa ore-logo">Ore <sup>Beta</sup></a></li>
                <li><a href="https://www.spongepowered.org/downloads"><i class="fa-fw fa fa-download"></i>Downloads</a></li>
                <li><a href="https://www.spongepowered.org/chat"><i class="fa-fw fa fa-comment"></i>Chat</a></li>
            </ul>
        </div>
    </div>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../server/index.html">建立伺服器</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../versions/index.html">版本控制方針</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../preparing/index.html">準備開發</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">建立插件</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api-versions.html">API版本</a></li>
<li class="toctree-l2"><a class="reference internal" href="../buildsystem.html">建置系統</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workspace/index.html">建立你的工作空間</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project/index.html">建立你的專案</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-identifier.html">插件識別碼</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-class.html">主要插件類別</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lifecycle.html">插件的生命週期</a></li>
<li class="toctree-l2"><a class="reference internal" href="../injection.html">相依注入</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practices/index.html">實踐</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optional/index.html">Optionals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging.html">記錄與除錯</a></li>
<li class="toctree-l2"><a class="reference internal" href="../text/index.html">文本</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">插件指令</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="creating.html">建立一個指令</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">引數剖析</a></li>
<li class="toctree-l3"><a class="reference internal" href="flags.html">指令旗標</a></li>
<li class="toctree-l3"><a class="reference internal" href="childcommands.html">子指令</a></li>
<li class="toctree-l3"><a class="reference internal" href="service.html">指令管理器</a></li>
<li class="toctree-l3"><a class="reference internal" href="commandcallable.html">低階指令 API</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../event/index.html">事件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/index.html">設定插件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assets.html">Asset API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html">Data API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blocks/index.html">方塊</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entities/index.html">實體</a></li>
<li class="toctree-l2"><a class="reference internal" href="../items/index.html">物品</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trade-offers.html">開設交易</a></li>
<li class="toctree-l2"><a class="reference internal" href="../effects.html">效果</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduler.html">排程</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services.html">服務</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database.html">資料庫</a></li>
<li class="toctree-l2"><a class="reference internal" href="../permissions.html">權限</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bans.html">封鎖</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html">Metrics 收集</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bookview.html">書本閱覽</a></li>
<li class="toctree-l2"><a class="reference internal" href="../economy/index.html">經濟</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wgen/index.html">世界生成</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manager.html">插件管理器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../game-profile-manager.html">遊戲設定檔管理器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../offline-userplayer-data.html">離線玩家資料</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tab-lists.html">Tab 清單</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-meta.html">插件元數據</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ray-tracing.html">光線追蹤</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging.html">插件除錯</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html">教學</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/index.html">相依於實作的插件</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ore/index.html">Ore 文件</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">為 Sponge 貢獻</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">關於 Sponge 專案</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Sponge</a>
      </nav>


      <div class="wy-nav-content">
        <div class="rst-content">

 

<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
          <li><a href="../index.html">建立插件</a> &raquo;</li>
          <li><a href="index.html">插件指令</a> &raquo;</li>
    <li>引數剖析</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/plugin/commands/arguments.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
  <div class="section" id="argument-parsing">
<h1>引數剖析<a class="headerlink" href="#argument-parsing" title="本標題的永久連結">¶</a></h1>
<p>命令生成器（Command Builder）的 API 附带了一个非常强大的参数解析器。它把字符串输入转换为 Java 的基本类型（整数、布尔值、字符串）或游戏中的对象（玩家、世界、方块类型等）。这一解析器支持可选参数和标志，它同时也可以处理使用 TAB 的参数自动补全。</p>
<p>解析过的参数存储在 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/CommandContext.html">CommandContext</a> 对象中。如果解析器返回了单个对象，可以通过 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/CommandContext.html#getOne-java.lang.String-">CommandContext#getOne(String)</a> 获取。可选参数和弱参数可能会返回 <code class="docutils literal notranslate"><span class="pre">Optional.empty()</span></code>。</p>
<p>很多解析器可能会返回多个对象（例如匹配用户名的多个玩家）。在这种情况下，你必须使用 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/CommandContext.html#getAll-java.lang.String-">CommandContext#getAll(String)</a> 以获取所有可能的匹配项对应的 <code class="docutils literal notranslate"><span class="pre">Collection</span></code>，<strong>否则上下文对象会抛出异常</strong>！</p>
<p>当创建命令时，应考虑某个参数是否可以有多个返回值，比如原本应该有玩家参数的地方是否可以用选择器来支持多个玩家。若如此做，玩家在使用这个命令的时候就可以只输入一条命令，并且语法看起来也会很简洁，比如：<code class="docutils literal notranslate"><span class="pre">/tell</span> <span class="pre">&#64;a</span> <span class="pre">Who</span> <span class="pre">took</span> <span class="pre">the</span> <span class="pre">cookies?</span></code></p>
<div class="admonition tip">
<p class="first admonition-title">小訣竅</p>
<p class="last">你可以使用 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/GenericArguments.html#onlyOne-org.spongepowered.api.command.args.CommandElement-">GenericArguments#onlyOne(CommandElement)</a> 元素来限制参数的返回数量，这样你可以安全使用 <code class="docutils literal notranslate"><span class="pre">args.&lt;T&gt;getOne(String)</span></code>。但用户仍然会在尝试选择多个值的时候收到相应的提示。</p>
</div>
<p>若要创建一个新的 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/CommandElement.html">CommandElement</a> （参数），请使用 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/GenericArguments.html">GenericArguments</a> 这一工厂类（Factory Class）。许多 <code class="docutils literal notranslate"><span class="pre">CommandElement</span></code> 都需要一段短文本用于显示帮助或错误信息。</p>
<p>使用 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/spec/CommandSpec.Builder.html#arguments-org.spongepowered.api.command.args.CommandElement...-">CommandSpec.Builder#arguments(CommandElement…)</a> 把 <code class="docutils literal notranslate"><span class="pre">CommandElement</span></code> 应用到命令生成器上。这一方法可以传入多个 <code class="docutils literal notranslate"><span class="pre">CommandElement</span></code> ，这样就可以解析多个参数（例如 <code class="docutils literal notranslate"><span class="pre">/msg</span> <span class="pre">&lt;player&gt;</span> <span class="pre">&lt;msg&gt;</span></code> ）。传入多个参数等价于使用 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/GenericArguments.html#seq-org.spongepowered.api.command.args.CommandElement...-">GenericArguments#seq(CommandElement…)</a> 把多个参数包装起来。</p>
<div class="section" id="example-building-a-command-with-multiple-arguments">
<h2>範例：建立一個具有多個引數的指令<a class="headerlink" href="#example-building-a-command-with-multiple-arguments" title="本標題的永久連結">¶</a></h2>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.Sponge</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.text.Text</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.entity.living.player.Player</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.CommandException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.CommandResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.CommandSource</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.args.CommandContext</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.args.GenericArguments</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.spec.CommandExecutor</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.spec.CommandSpec</span><span class="p">;</span>

<span class="n">PluginContainer</span> <span class="n">plugin</span> <span class="o">=</span> <span class="p">...;</span>

<span class="n">CommandSpec</span> <span class="n">myCommandSpec</span> <span class="o">=</span> <span class="n">CommandSpec</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
        <span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;Send a message to a player&quot;</span><span class="p">))</span>
        <span class="p">.</span><span class="na">permission</span><span class="p">(</span><span class="s">&quot;myplugin.command.message&quot;</span><span class="p">)</span>

        <span class="p">.</span><span class="na">arguments</span><span class="p">(</span>
                <span class="n">GenericArguments</span><span class="p">.</span><span class="na">onlyOne</span><span class="p">(</span><span class="n">GenericArguments</span><span class="p">.</span><span class="na">player</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;player&quot;</span><span class="p">))),</span>
                <span class="n">GenericArguments</span><span class="p">.</span><span class="na">remainingJoinedStrings</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;message&quot;</span><span class="p">)))</span>

        <span class="p">.</span><span class="na">executor</span><span class="p">((</span><span class="n">CommandSource</span> <span class="n">src</span><span class="p">,</span> <span class="n">CommandContext</span> <span class="n">args</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">{</span>

            <span class="n">Player</span> <span class="n">player</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="o">&lt;</span><span class="n">Player</span><span class="o">&gt;</span><span class="n">getOne</span><span class="p">(</span><span class="s">&quot;player&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>
            <span class="n">String</span> <span class="n">message</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="n">getOne</span><span class="p">(</span><span class="s">&quot;message&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">();</span>

            <span class="n">player</span><span class="p">.</span><span class="na">sendMessage</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">message</span><span class="p">));</span>

            <span class="k">return</span> <span class="n">CommandResult</span><span class="p">.</span><span class="na">success</span><span class="p">();</span>
        <span class="p">})</span>
        <span class="p">.</span><span class="na">build</span><span class="p">();</span>

<span class="n">Sponge</span><span class="p">.</span><span class="na">getCommandManager</span><span class="p">().</span><span class="na">register</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="n">myCommandSpec</span><span class="p">,</span> <span class="s">&quot;message&quot;</span><span class="p">,</span> <span class="s">&quot;msg&quot;</span><span class="p">,</span> <span class="s">&quot;m&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="overview-of-the-genericarguments-command-elements">
<h2>對於 <code class="docutils literal notranslate"><span class="pre">GenericArguments</span></code> 指令元素的概述<a class="headerlink" href="#overview-of-the-genericarguments-command-elements" title="本標題的永久連結">¶</a></h2>
<table border="1" class="docutils">
<colgroup>
<col width="19%" />
<col width="60%" />
<col width="21%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">指令元素</th>
<th class="head">說明</th>
<th class="head">值的型態與數量</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">none</span></code></td>
<td>期望没有参数，这也是 <code class="docutils literal notranslate"><span class="pre">CommandSpec</span></code> 的默认行为。</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td colspan="3"><strong>Java 基本型態</strong></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">string</span></code></td>
<td>期望一个表示字符串的参数。</td>
<td>一個 <code class="docutils literal notranslate"><span class="pre">String</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">remainingJoinedStrings</span></code></td>
<td>把所有剩余的参数使用空格连接起来（对于消息命令来说十分有用）。</td>
<td>一個 <code class="docutils literal notranslate"><span class="pre">String</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">bool</span></code></td>
<td>期望一个表示布尔值的参数。</td>
<td>一個 <code class="docutils literal notranslate"><span class="pre">Boolean</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">integer</span></code></td>
<td>期望一个表示整数的参数。</td>
<td>一個 <code class="docutils literal notranslate"><span class="pre">Integer</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">doubleNum</span></code></td>
<td>期望一个表示浮点数的参数。</td>
<td>一個 <code class="docutils literal notranslate"><span class="pre">Double</span></code></td>
</tr>
<tr class="row-odd"><td colspan="3"><strong>遊戲物件</strong></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">player</span></code></td>
<td>期望一个表示在线玩家的参数，并 <strong>可能返回多个玩家</strong> ！</td>
<td>多個 <code class="docutils literal notranslate"><span class="pre">Player</span></code> 實例</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">playerOrSource</span></code></td>
<td>和 <code class="docutils literal notranslate"><span class="pre">player</span></code> 类似，但在没有找到匹配的玩家时返回命令的执行者。</td>
<td>多個 <code class="docutils literal notranslate"><span class="pre">Player</span></code> 實例</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">userOrSource</span></code></td>
<td>和 <code class="docutils literal notranslate"><span class="pre">playerOrSource</span></code> 类似，只不过返回一个用户（ <code class="docutils literal notranslate"><span class="pre">User</span></code> ）而不是玩家。</td>
<td>多個 <code class="docutils literal notranslate"><span class="pre">User</span></code> 實例</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">world</span></code></td>
<td>期望一个表示世界的参数（包括尚未加载的世界）。</td>
<td>多個 <code class="docutils literal notranslate"><span class="pre">WorldProperties</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">dimension</span></code></td>
<td>期望一个表示维度的参数（如 <code class="docutils literal notranslate"><span class="pre">END</span></code> 、 <code class="docutils literal notranslate"><span class="pre">NETHER</span></code> 、和 <code class="docutils literal notranslate"><span class="pre">OVERWORLD</span></code> ）。</td>
<td>多個 <code class="docutils literal notranslate"><span class="pre">DimensionType</span></code> 實例</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">location</span></code></td>
<td>期望一个表示坐标（ <code class="docutils literal notranslate"><span class="pre">Location</span></code> ）的参数。</td>
<td>一個 <code class="docutils literal notranslate"><span class="pre">Location</span></code></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">vector3d</span></code></td>
<td>期望一个表示坐标（ <code class="docutils literal notranslate"><span class="pre">Vector3d</span></code> ）的参数。</td>
<td>一個 <code class="docutils literal notranslate"><span class="pre">Vector3d</span></code></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">catalogedElement</span></code></td>
<td>期望一个表示特定 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/CatalogType.html">CatalogType</a> 成员的参数。</td>
<td>多个匹配特定索引类型（Catalog Type）的实例</td>
</tr>
<tr class="row-even"><td colspan="3"><strong>匹配器</strong></td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">choices</span></code></td>
<td>返回一个允许从一组特定的值中选定的参数。</td>
<td>一个特定的值</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">literal</span></code></td>
<td>期望一个表示特定文本序列的参数（例如 <code class="docutils literal notranslate"><span class="pre">&quot;i&quot;,</span> <span class="pre">&quot;luv&quot;,</span> <span class="pre">&quot;u&quot;</span></code> 表示 <code class="docutils literal notranslate"><span class="pre">/cmd</span> <span class="pre">i</span> <span class="pre">luv</span> <span class="pre">u</span></code> ），如果不匹配则抛出一个异常。</td>
<td>一个特定的值</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">enumValue</span></code></td>
<td>期望一个表示给定枚举类型的值的参数。</td>
<td>多个匹配给定枚举的元素</td>
</tr>
<tr class="row-even"><td colspan="3"><p class="first"><strong>辅助元素</strong></p>
<p class="last">用于把若干命令元素包装起来。其值类型是从被包装元素继承的。</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">seq</span></code></td>
<td>生成一串命令元素的序列（例如 <code class="docutils literal notranslate"><span class="pre">/cmd</span> <span class="pre">&lt;arg1&gt;</span> <span class="pre">&lt;arg2&gt;</span> <span class="pre">&lt;arg3&gt;</span></code> ）。</td>
<td>繼承</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">repeated</span></code></td>
<td>期望一个表示重复数次的命令元素。</td>
<td>多個繼承</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">allOf</span></code></td>
<td>期望所有剩余的参数匹配给定命令元素。</td>
<td>多個繼承</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">optional</span></code></td>
<td>使给定的命令元素可选。如果参数的格式无效或并没有更多的参数，将抛出一个异常。</td>
<td>繼承</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">optionalWeak</span></code></td>
<td>使给定的命令元素可选。如果参数的格式无效或并没有更多的参数，将不会抛出一个异常。</td>
<td>繼承</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">firstParsing</span></code></td>
<td>返回给定命令元素中第一个可解析的元素（对像是 <code class="docutils literal notranslate"><span class="pre">/settime</span> <span class="pre">&lt;day|night|&lt;number&gt;</span></code> 这种命令重载的情况有用）。</td>
<td>繼承</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">onlyOne</span></code></td>
<td>限制给定命令元素，使其只允许在给定上下文插入仅仅一个。</td>
<td>繼承</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">flags</span></code></td>
<td><p class="first">返回一个标志（Flag）生成器（例如 <code class="docutils literal notranslate"><span class="pre">/cmd</span> <span class="pre">[-a]</span> <span class="pre">[-b</span> <span class="pre">&lt;value&gt;]</span></code> ）。</p>
<p class="last">請參閱 <a class="reference internal" href="flags.html"><span class="doc">指令旗標</span></a></p>
</td>
<td><p class="first">短旗標（Short Flag）：一個 <code class="docutils literal notranslate"><span class="pre">Boolean</span></code></p>
<p>長旗標（Long Flag）：一個 <code class="docutils literal notranslate"><span class="pre">String</span></code></p>
<p class="last">數值旗標（Value Flag）：繼承</p>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">requiringPermission</span></code></td>
<td>要求命令执行者拥有使用给定命令参数的特定权限</td>
<td>繼承</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">requiringPermissionWeak</span></code></td>
<td>Requires the command sender to have the specified permission in order to use the given
command argument. Does not throw an error if the user does not have the permission.</td>
<td>繼承</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="first admonition-title">小訣竅</p>
<p class="last">详见 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/GenericArguments.html">GenericArguments</a> 以获取更详细的信息。</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">警告</p>
<p class="last">不要认为 <code class="docutils literal notranslate"><span class="pre">CommandElement</span></code> 只会有一个返回值，事实上他们当中很多都支持多重返回值，甚至有些还支持正则表达式或命令选择器。这样做是为了让命令系统更容易使用。例子：<code class="docutils literal notranslate"><span class="pre">/tell</span> <span class="pre">&#64;a</span> <span class="pre">BanditPlayer</span> <span class="pre">has</span> <span class="pre">the</span> <span class="pre">cookies!</span></code>。如果你希望某个参数永远只有一个返回值，请使用 <code class="docutils literal notranslate"><span class="pre">GenericArguments#onlyOne(CommandElement)</span></code>。</p>
</div>
</div>
<div class="section" id="custom-command-elements">
<h2>自定義指令元素<a class="headerlink" href="#custom-command-elements" title="本標題的永久連結">¶</a></h2>
<p>可以通过继承 <code class="docutils literal notranslate"><span class="pre">CommandElement</span></code> 类创建自定义命令元素（如解析 URL 或者一个 <code class="docutils literal notranslate"><span class="pre">Vector2i</span></code> 元素）。</p>
<p><a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/CommandElement.html#parseValue-org.spongepowered.api.command.CommandSource-org.spongepowered.api.command.args.CommandArgs-">CommandElement#parseValue(CommandSource, CommandArgs)</a> 方法需要通过 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/CommandArgs.html#next--">CommandArgs#next()</a> 方法获取没有处理过的字符串并将其转换为一个对象（Object），如果转换出错，应抛出一个 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/ArgumentParseException.html">ArgumentParseException</a> 异常。</p>
<p><a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/CommandElement.html#complete-org.spongepowered.api.command.CommandSource-org.spongepowered.api.command.args.CommandArgs-org.spongepowered.api.command.args.CommandContext-">CommandElement#complete(CommandSource, CommandArgs, CommandContext)</a> 方法应使用 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/args/CommandArgs.html#peek--">CommandArgs#peek()</a> 方法读取下一个未处理过的参数。其返回一个 TAB 自动补全的列表。</p>
<div class="section" id="example-vector2i-command-element-definition">
<h3>範例：<code class="docutils literal notranslate"><span class="pre">Vector2i</span></code> 指令元素定義<a class="headerlink" href="#example-vector2i-command-element-definition" title="本標題的永久連結">¶</a></h3>
<p>在这一示例中，解析器读取两个传入的参数并将其转换为一个 <code class="docutils literal notranslate"><span class="pre">Vector2i</span></code> 。</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">com.flowpowered.math.vector.Vector2i</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.args.ArgumentParseException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.args.CommandArgs</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.text.Text</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.args.CommandElement</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Collections</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">Vector2iCommandElement</span> <span class="kd">extends</span> <span class="n">CommandElement</span> <span class="p">{</span>

    <span class="kd">protected</span> <span class="nf">Vector2iCommandElement</span><span class="p">(</span><span class="n">Text</span> <span class="n">key</span><span class="p">)</span> <span class="p">{</span>
        <span class="kd">super</span><span class="p">(</span><span class="n">key</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">protected</span> <span class="n">Object</span> <span class="nf">parseValue</span><span class="p">(</span><span class="n">CommandSource</span> <span class="n">source</span><span class="p">,</span> <span class="n">CommandArgs</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">ArgumentParseException</span> <span class="p">{</span>

        <span class="n">String</span> <span class="n">xInput</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
        <span class="kt">int</span> <span class="n">x</span> <span class="o">=</span> <span class="n">parseInt</span><span class="p">(</span><span class="n">xInput</span><span class="p">,</span> <span class="n">args</span><span class="p">);</span>

        <span class="n">String</span> <span class="n">yInput</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
        <span class="kt">int</span> <span class="n">y</span> <span class="o">=</span> <span class="n">parseInt</span><span class="p">(</span><span class="n">yInput</span><span class="p">,</span> <span class="n">args</span><span class="p">);</span>

        <span class="k">return</span> <span class="k">new</span> <span class="n">Vector2i</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">private</span> <span class="kt">int</span> <span class="nf">parseInt</span><span class="p">(</span><span class="n">String</span> <span class="n">input</span><span class="p">,</span> <span class="n">CommandArgs</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">ArgumentParseException</span> <span class="p">{</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="k">return</span> <span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="n">NumberFormatException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="n">args</span><span class="p">.</span><span class="na">createError</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="n">input</span> <span class="o">+</span> <span class="s">&quot;&#39; is not a valid number!&quot;</span><span class="p">));</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">complete</span><span class="p">(</span><span class="n">CommandSource</span> <span class="n">src</span><span class="p">,</span> <span class="n">CommandArgs</span> <span class="n">args</span><span class="p">,</span> <span class="n">CommandContext</span> <span class="n">context</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">Collections</span><span class="p">.</span><span class="na">emptyList</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="nd">@Override</span>
    <span class="kd">public</span> <span class="n">Text</span> <span class="nf">getUsage</span><span class="p">(</span><span class="n">CommandSource</span> <span class="n">src</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;&lt;x&gt; &lt;y&gt;&quot;</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="example-vector2i-command-element-usage">
<h3>範例：<code class="docutils literal notranslate"><span class="pre">Vector2i</span></code> 指令元素用法<a class="headerlink" href="#example-vector2i-command-element-usage" title="本標題的永久連結">¶</a></h3>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// /plottp &lt;x&gt; &lt;y&gt;</span>
<span class="n">CommandSpec</span> <span class="n">myCommandSpec</span> <span class="o">=</span> <span class="n">CommandSpec</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
        <span class="p">.</span><span class="na">description</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;Teleport to a plot&quot;</span><span class="p">))</span>
        <span class="p">.</span><span class="na">permission</span><span class="p">(</span><span class="s">&quot;myplugin.command.plot.tp&quot;</span><span class="p">)</span>

        <span class="p">.</span><span class="na">arguments</span><span class="p">(</span><span class="k">new</span> <span class="n">Vector2iCommandElement</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;coordinates&quot;</span><span class="p">)))</span>

        <span class="p">.</span><span class="na">executor</span><span class="p">(</span><span class="k">new</span> <span class="n">MyCommandExecutor</span><span class="p">())</span>
        <span class="p">.</span><span class="na">build</span><span class="p">();</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">小訣竅</p>
<p class="last">请参阅<a class="reference external" href="https://github.com/SpongePowered/SpongeAPI/blob/stable-7/src/main/java/org/spongepowered/api/command/args/GenericArguments.java">源代码</a>以获取更多关于 <code class="docutils literal notranslate"><span class="pre">GenericArguments</span></code> 类的用法示例。</p>
</div>
</div>
<div class="section" id="using-selectors-in-custom-command-elements">
<h3>在自定義指令元素使用選擇器<a class="headerlink" href="#using-selectors-in-custom-command-elements" title="本標題的永久連結">¶</a></h3>
<p>Sponge 提供了解析选择器的支持，所以你可以在自定义元素中使用选择器。使用选择器需要走两步：<strong>解析</strong>（从字符串中构建出 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/text/selector/Selector.html">Selector</a>）和<strong>解释</strong>（根据选择器获得一个包含所有被选中的 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/entity/Entity.html">Entity</a> 的集合）。</p>
<p><strong>解析</strong>选择器字符串需用到 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/text/selector/Selector.html#parse-java.lang.String-">Selector#parse(String)</a> 方法，为此需要传入整个选择器字符串（包含 <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>）。该方法会返回可用于查询和解释的 <code class="docutils literal notranslate"><span class="pre">Selector</span></code> 对象。注意，如果传入的字符串不是合法的选择器字符串，该方法会抛出一个 <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/lang/IllegalArgumentException.html">IllegalArgumentException</a> 异常。</p>
<p>请使用 <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/text/selector/Selector.html#resolve-org.spongepowered.api.command.CommandSource-">Selector#resolve(CommandSource)</a> 来<strong>解释</strong>该选择器，它将返回一个包含有该选择器匹配中的所有 <code class="docutils literal notranslate"><span class="pre">Entity</span></code> 的集合。</p>
<p>下面的 <code class="docutils literal notranslate"><span class="pre">CommandElement</span></code> 类的 <code class="docutils literal notranslate"><span class="pre">parseValue</span></code> 方法会尝试解析一个选择器，并根据 <code class="docutils literal notranslate"><span class="pre">CommandSource</span></code> 的位置返回一个实体的集合。若传入的字符串开头不是 <code class="docutils literal notranslate"><span class="pre">&#64;</span></code>，会抛出一个异常告知目标字符串不是选择器。</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="nd">@Override</span>
<span class="kd">protected</span> <span class="n">Object</span> <span class="nf">parseValue</span><span class="p">(</span><span class="n">CommandSource</span> <span class="n">source</span><span class="p">,</span> <span class="n">CommandArgs</span> <span class="n">args</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">ArgumentParseException</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">nextArg</span> <span class="o">=</span> <span class="n">args</span><span class="p">.</span><span class="na">next</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">nextArg</span><span class="p">.</span><span class="na">startsWith</span><span class="p">(</span><span class="s">&quot;@&quot;</span><span class="p">))</span> <span class="p">{</span>
        <span class="n">Set</span><span class="o">&lt;</span><span class="n">Entity</span><span class="o">&gt;</span> <span class="n">selectedEntities</span><span class="p">;</span>
        <span class="k">try</span> <span class="p">{</span>
            <span class="n">selectedEntities</span> <span class="o">=</span> <span class="n">Selector</span><span class="p">.</span><span class="na">parse</span><span class="p">(</span><span class="n">nextArg</span><span class="p">).</span><span class="na">resolve</span><span class="p">(</span><span class="n">source</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="n">IllegalArgumentException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="n">args</span><span class="p">.</span><span class="na">createError</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;Could not parse selector.&quot;</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">selectedEntities</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span> <span class="p">{</span>
            <span class="k">throw</span> <span class="n">args</span><span class="p">.</span><span class="na">createError</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;No entities selected.&quot;</span><span class="p">));</span>
        <span class="p">}</span>

        <span class="k">return</span> <span class="n">selectedEntities</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">throw</span> <span class="n">args</span><span class="p">.</span><span class="na">createError</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;Not a selector.&quot;</span><span class="p">));</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">小訣竅</p>
<p class="last">关于标准 Sponge 中的 <code class="docutils literal notranslate"><span class="pre">CommandElements</span></code> 中选择器解析的具体过程，可参阅 <a class="reference external" href="https://github.com/SpongePowered/SpongeAPI/blob/stable-7/src/main/java/org/spongepowered/api/command/args/SelectorCommandElement.java#L40">SelectorCommandElement 类的源码</a>。</p>
</div>
</div>
</div>
</div>

           </div>
          </div>
<footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="flags.html" class="btn btn-neutral float-right" title="指令旗標" accesskey="n" rel="next">下一頁 <span class="fa fa-angle-right"></span></a>
        <a href="creating.html" class="btn btn-neutral" title="建立一個指令" accesskey="p" rel="prev"><span class="fa fa-angle-left"></span> 上一頁</a>
    </div>

    <hr/>

    <section id="license-footer">
        <p>Except where otherwise noted,
            <a xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" property="dct:title" rel="cc:attributionURL" href="https://github.com/SpongePowered/SpongeDocs">SpongeDocs</a>
            is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
        </p>
        <a id="license-icons" rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" title="CC-BY-SA" aria-hidden="true">cba</a>
    </section>
</footer>        </div>
      </div>

    </section>

  </div>


<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <i class="fa fa-book"> <span>SpongeDocs</span></i>
        v: 7.2.0
    <img src="../../_static/flags/zh_TW.svg"
         alt="zh-TW" title="繁體中文">
        <span class="fa fa-caret-down"></span>
    </span>
    <div id="versions" class="rst-other-versions">




    </div>
</div>

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'7.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>      <script type="text/javascript" src="../../_static/jquery.js"></script>      <script type="text/javascript" src="../../_static/underscore.js"></script>      <script type="text/javascript" src="../../_static/doctools.js"></script>      <script type="text/javascript" src="../../_static/language_data.js"></script>      <script type="text/javascript" src="../../_static/translations.js"></script>      <script type="text/javascript" src="../../_static/spongedocs.js"></script>

    <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
 
</body>
</html>