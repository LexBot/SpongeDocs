
<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Loaders de Configuration &mdash; Documentation Sponge 7.2.0</title>

    <link rel="shortcut icon" href="../../_static/favicon.ico"/>




    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

    <link rel="stylesheet" href="../../_static/spongedocs.css" type="text/css" />

        <link rel="index" title="Index"
              href="../../genindex.html"/>        <link rel="search" title="Recherche" href="../../search.html"/>    <link rel="top" title="Documentation Sponge 7.2.0" href="../../index.html"/>        <link rel="up" title="Configuration des plugins" href="index.html"/>        <link rel="next" title="Configuration des Nodes" href="nodes.html"/>        <link rel="prev" title="Configuration des plugins" href="index.html"/>
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
    <div id="sp-logo-container" class="page-scroll">
        <a class="logo" href="../../index.html">
            <img src="../../_static/spongie-mark-dark.svg">
            <span>Sponge</span>
            <i class="fa fa-fw fa-chevron-down"></i>
        </a>
        <div id="sp-logo-menu">
            <ul id="sp-logo-dropdown">
                <li><a href="https://www.spongepowered.org"><i class="fa-fw fa fa-home"></i>Homepage</a></li>
                <li><a href="https://forums.spongepowered.org"><i class="fa-fw fa fa-comments"></i>Forums</a></li>
                <li><a href="https://github.com/SpongePowered"><i class="fa-fw fa fa-code"></i>Code</a></li>
                <li class="active"><a href="https://docs.spongepowered.org"><i class="fa-fw fa fa-book"></i>Docs</a></li>
                <li><a href="https://jd.spongepowered.org"><i class="fa-fw fa fa-graduation-cap"></i>Javadocs</a></li>
                <li><a href="https://forums.spongepowered.org/c/plugins/plugin-releases"><i class="fa-fw fa fa-plug"></i>Plugins</a></li>
                <li><a href="https://ore.spongepowered.org"><img src="../../_static/ore.svg" alt="" class="fa-fw fa ore-logo">Ore <sup>Beta</sup></a></li>
                <li><a href="https://www.spongepowered.org/downloads"><i class="fa-fw fa fa-download"></i>Downloads</a></li>
                <li><a href="https://www.spongepowered.org/chat"><i class="fa-fw fa fa-comment"></i>Chat</a></li>
            </ul>
        </div>
    </div>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../server/index.html">Créer un Serveur</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../versions/index.html">Stratégie de versioning</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../preparing/index.html">Préparation pour le développement</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Création d’un Plugin</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api-versions.html">Versions de l’API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../buildsystem.html">Build Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workspace/index.html">Mise en Place de votre Espace de Travail</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project/index.html">Configurer Votre Projet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-identifier.html">Identifiants de Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-class.html">Classe Principale du Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lifecycle.html">Cycle de vie des Plugins</a></li>
<li class="toctree-l2"><a class="reference internal" href="../injection.html">Injection de Dépendances</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practices/index.html">Bonnes Pratiques</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optional/index.html">Optionnels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging.html">Journalisation (Logging) et Débogage</a></li>
<li class="toctree-l2"><a class="reference internal" href="../text/index.html">Text</a></li>
<li class="toctree-l2"><a class="reference internal" href="../commands/index.html">Commandes de Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../event/index.html">Événements</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Configuration des plugins</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Loaders de Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="nodes.html">Configuration des Nodes</a></li>
<li class="toctree-l3"><a class="reference internal" href="serialization.html">Sérialisation d’objets</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../assets.html">L’API des Ressources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html">La Data API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blocks/index.html">Blocs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entities/index.html">Entités</a></li>
<li class="toctree-l2"><a class="reference internal" href="../items/index.html">Items</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trade-offers.html">Trade-Offers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../effects.html">Effets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduler.html">Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services.html">Services</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database.html">Bases de données</a></li>
<li class="toctree-l2"><a class="reference internal" href="../permissions.html">Permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bans.html">Bans</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html">Collection de Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bookview.html">Views d’un Livre</a></li>
<li class="toctree-l2"><a class="reference internal" href="../economy/index.html">Économie</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wgen/index.html">Génération du monde</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manager.html">Gestionnaire de Plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../game-profile-manager.html">Gestionnaire de Profil de Jeu</a></li>
<li class="toctree-l2"><a class="reference internal" href="../offline-userplayer-data.html">Données du Joueur Hors-Ligne</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tab-lists.html">Tab Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-meta.html">Plugin Metadata</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ray-tracing.html">Ray Tracing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging.html">Debugging d’un plugin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html">Tutoriels</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/index.html">Plugins dépendants des implémentations</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ore/index.html">Documentation d’Ore</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Contribuer à Sponge</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">À propos du Projet Sponge</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Sponge</a>
      </nav>


      <div class="wy-nav-content">
        <div class="rst-content">

 

<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
          <li><a href="../index.html">Création d’un Plugin</a> &raquo;</li>
          <li><a href="index.html">Configuration des plugins</a> &raquo;</li>
    <li>Loaders de Configuration</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/plugin/configuration/loaders.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
  <div class="section" id="configuration-loaders">
<h1>Loaders de Configuration<a class="headerlink" href="#configuration-loaders" title="Lien permanent vers ce titre">¶</a></h1>
<p>Décomposons la manière dont Configurate fonctionne, en commençant par le processus de chargement. Configurate fournit des <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/loader/ConfigurationLoader.html">ConfigurationLoader</a>s pour les formats courants de configuration, comme le gestionnaire de fichiers physiques de votre configuration, vous permettant de sauvegarder et de charger les données d’une ressource donnée. Ils permettent aussi de charger des configurations vides, vous permettant de hard-coder des valeurs par défaut ou de les charger depuis un fichier pré-écrit.</p>
<div class="admonition tip">
<p class="first admonition-title">Astuce</p>
<p class="last">Le format de configuration par défaut et recommandé pour les plugins Sponge est HOCON.</p>
</div>
<div class="section" id="getting-your-loader">
<h2>Obtenir votre Loader<a class="headerlink" href="#getting-your-loader" title="Lien permanent vers ce titre">¶</a></h2>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Si vous utilisez un seul fichier de configuration HOCON, le <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/loader/ConfigurationLoader.html">ConfigurationLoader</a> par défaut peut être utilisé à la place; voir la <a class="reference internal" href="index.html"><span class="doc">page de configuration principale</span></a>.</p>
</div>
<p>Tout d’abord, prenons un nouveau <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/hocon/HoconConfigurationLoader.html">HoconConfigurationLoader</a> qui pointe vers notre fichier de configuration.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.nio.file.Path</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">ninja.leaping.configurate.commented.CommentedConfigurationNode</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">ninja.leaping.configurate.hocon.HoconConfigurationLoader</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">ninja.leaping.configurate.loader.ConfigurationLoader</span><span class="p">;</span>

<span class="n">Path</span> <span class="n">potentialFile</span> <span class="o">=</span> <span class="n">getConfigPath</span><span class="p">();</span>
<span class="n">ConfigurationLoader</span><span class="o">&lt;</span><span class="n">CommentedConfigurationNode</span><span class="o">&gt;</span> <span class="n">loader</span> <span class="o">=</span>
        <span class="n">HoconConfigurationLoader</span><span class="p">.</span><span class="na">builder</span><span class="p">().</span><span class="na">setPath</span><span class="p">(</span><span class="n">potentialFile</span><span class="p">).</span><span class="na">build</span><span class="p">();</span>
</pre></div>
</div>
<p>Le Loader va également gérer un type générique dépendant de quel type de note il va construire. Ces <em>Configuration Nodes</em> seront expliqués dans <a class="reference internal" href="nodes.html"><span class="doc">une section par la suite</span></a>.</p>
<p>Les <code class="docutils literal notranslate"><span class="pre">ConfigurationLoader</span></code>s contiennent habituellement un builder pour que vous puissiez accéder et créer statiquement une nouvelle instance du loader du type souhaité. Pour une configuration basique, nous n’avons pas vraiment besoin de spécifier autre chose que le fichier que nous voulons charger et/ou sauvegarder, donc tout ce que nous allons faire est de lui dire exactement cela, en utilisant <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/loader/AbstractConfigurationLoader.Builder.html#setPath-java.nio.file.Path-">HoconConfigurationLoader.builder().setPath(path)</a>. Nous allons ensuite utiliser le builder afin de construire l’instance (<a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/hocon/HoconConfigurationLoader.Builder.html#build--">build()</a>) pour lui et le stocker dans une variable.</p>
<p>Bien sûr, ce n’est pas le seul moyen de charger un fichier. Le builder possède également une méthode <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/loader/AbstractConfigurationLoader.Builder.html#setURL-java.net.URL-">setURL(url)</a>, au cas où vous souhaitez charger une ressource sans utiliser d’objet <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/nio/file/Path.html">Path</a>. Gardez à l’esprit que les Loaders de Configuration créés depuis une <a class="reference external" href="https://docs.oracle.com/javase/8/docs/api/java/net/URL.html">URL</a> ne peuvent être que lus puisqu’il n’y a aucun moyen d’écrire des données en passant par une URL.</p>
<p>Cette fonctionnalité peut servir à regrouper les configurations par défaut avec le fichier jar de votre plugin et les charger dans la configuration initiale pour être éditées par l’administrateur du serveur (ou par votre plugin lui-même).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Cet exemple utilise un <code class="docutils literal notranslate"><span class="pre">HoconConfigurationLoader</span></code>, qui est l’approche recommandée pour les plugins Sponge, mais vous pouvez également utiliser un <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/yaml/YAMLConfigurationLoader.html">YAMLConfigurationLoader</a> ou un <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/gson/GsonConfigurationLoader.html">GsonConfigurationLoader</a> pour charger des anciennes configurations.</p>
</div>
</div>
<div class="section" id="loading-and-saving">
<h2>Charger et Sauvegarder<a class="headerlink" href="#loading-and-saving" title="Lien permanent vers ce titre">¶</a></h2>
<p>Une fois que vous avez obtenu votre <code class="docutils literal notranslate"><span class="pre">ConfigurationLoader</span></code>, vous pouvez l’utiliser pour obtenir un <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/ConfigurationNode.html">ConfigurationNode</a> vide en utilisant la méthode <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/loader/ConfigurationLoader.html#createEmptyNode--">createEmptyNode()</a>.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ninja.leaping.configurate.ConfigurationNode</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">ninja.leaping.configurate.ConfigurationOptions</span><span class="p">;</span>

<span class="n">Path</span> <span class="n">potentialFile</span> <span class="o">=</span> <span class="n">getConfigPath</span><span class="p">();</span>
<span class="n">ConfigurationLoader</span><span class="o">&lt;</span><span class="n">CommentedConfigurationNode</span><span class="o">&gt;</span> <span class="n">loader</span> <span class="o">=</span>
        <span class="n">HoconConfigurationLoader</span><span class="p">.</span><span class="na">builder</span><span class="p">().</span><span class="na">setPath</span><span class="p">(</span><span class="n">potentialFile</span><span class="p">).</span><span class="na">build</span><span class="p">();</span>
<span class="n">ConfigurationNode</span> <span class="n">rootNode</span> <span class="o">=</span> <span class="n">loader</span><span class="p">.</span><span class="na">createEmptyNode</span><span class="p">(</span><span class="n">ConfigurationOptions</span><span class="p">.</span><span class="na">defaults</span><span class="p">());</span>
</pre></div>
</div>
<p>Cette méthode attend un paramètre <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/ConfigurationOptions.html">ConfigurationOptions</a>. Sauf si vous voulez utilisez des fonctionnalités comme la sérialisation de types customisés, vous pouvez juste utiliser <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/ConfigurationOptions.html#defaults--">ConfigurationOptions#defaults()</a> pour créer un objet d’options avec les valeurs par défaut.</p>
<p>En utilisant la méthode <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/loader/ConfigurationLoader.html#load--">load()</a>, vous pouvez essayer de charger les contenus de la configuration à partir de la source spécifié à la création du <code class="docutils literal notranslate"><span class="pre">ConfigurationLoader</span></code>. Il attend aussi une instance de <code class="docutils literal notranslate"><span class="pre">ConfigurationOptions</span></code>, mais fournit aussi une forme sans argument qui est un raccourci pour <a class="reference external" href="https://configurate.aoeu.xyz/apidocs/ninja/leaping/configurate/loader/ConfigurationLoader.html#load-ninja.leaping.configurate.ConfigurationOptions-">load(ConfigurationOptions.defaults())</a>.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">java.io.IOException</span><span class="p">;</span>

<span class="n">Path</span> <span class="n">potentialFile</span> <span class="o">=</span> <span class="n">getConfigPath</span><span class="p">();</span>
<span class="n">ConfigurationLoader</span><span class="o">&lt;</span><span class="n">CommentedConfigurationNode</span><span class="o">&gt;</span> <span class="n">loader</span> <span class="o">=</span>
        <span class="n">HoconConfigurationLoader</span><span class="p">.</span><span class="na">builder</span><span class="p">().</span><span class="na">setPath</span><span class="p">(</span><span class="n">potentialFile</span><span class="p">).</span><span class="na">build</span><span class="p">();</span>
<span class="n">ConfigurationNode</span> <span class="n">rootNode</span><span class="p">;</span>
<span class="k">try</span> <span class="p">{</span>
    <span class="n">rootNode</span> <span class="o">=</span> <span class="n">loader</span><span class="p">.</span><span class="na">load</span><span class="p">();</span>
<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// handle error</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Si le <code class="docutils literal notranslate"><span class="pre">Path</span></code> donné n’existe pas, la méthode <code class="docutils literal notranslate"><span class="pre">load()</span></code> va créer un <code class="docutils literal notranslate"><span class="pre">ConfigurationNode</span></code> vide. Toute autre erreur va mener à une <code class="docutils literal notranslate"><span class="pre">IOException</span></code> étant levée dont vous aurez besoin pour gérer correctement le problème.</p>
<p>Si vous avez injecté le loader par défaut, c’est une bonne idée de récupérer son <code class="docutils literal notranslate"><span class="pre">ConfigurationOptions</span></code>, puisque qu’il contient l’abilité de sérialiser et de désérialiser un grand nombre d’objets de Sponge.</p>
<p>Une fois que vous avez modifié votre <code class="docutils literal notranslate"><span class="pre">ConfigurationNode</span></code> pour garder les données que vous aimeriez sauvegarder, vous pouvez utiliser le <code class="docutils literal notranslate"><span class="pre">ConfigurationLoader</span></code> pour sauvegarder la node au fichier spécifié à la création du loader. Si ce fichier n’existe pas, il sera créé. Si il existe, tout son contenu sera écrasé.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="k">try</span> <span class="p">{</span>
    <span class="n">loader</span><span class="p">.</span><span class="na">save</span><span class="p">(</span><span class="n">rootNode</span><span class="p">);</span>
<span class="p">}</span> <span class="k">catch</span><span class="p">(</span><span class="n">IOException</span> <span class="n">e</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// handle error</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Encore une fois, les erreurs seront propagés en tant qu”<code class="docutils literal notranslate"><span class="pre">IOException</span></code> et doivent être gérées.</p>
<div class="admonition tip">
<p class="first admonition-title">Astuce</p>
<p class="last">Nous recommandons de sauvegarder la configuration après l’avoir chargé (pour la première fois après une mise à jour) pour s’assurer que les options de configuration nouvellement ajoutées ou migrées soient écrites sur le disque. Si vous avez besoin de sauvegarder la configuration plus tard, il est fortement recommandé de le faire en dehors du thread principal. Voir également les <a class="reference internal" href="../practices/bad.html"><span class="doc">Mauvaises Pratiques</span></a> que vous devez éviter.</p>
</div>
</div>
<div class="section" id="loading-a-default-config-from-the-plugin-jar-file">
<h2>Charger une configuration par défaut à partir d’un fichier du jar de votre plugin<a class="headerlink" href="#loading-a-default-config-from-the-plugin-jar-file" title="Lien permanent vers ce titre">¶</a></h2>
<p>Une méthode répandue pour fournir un fichier de configuration par défaut est de l’inclure dans le jar de votre plugin et le copier s’il n’existe pas déjà. Vous pouvez utiliser <a class="reference internal" href="../assets.html"><span class="doc">l’API Asset</span></a> pour ça, comme montré dans cet exemple:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">PluginContainer</span> <span class="n">plugin</span> <span class="o">=</span> <span class="p">...;</span>
<span class="n">Path</span> <span class="n">path</span> <span class="o">=</span> <span class="p">...;</span>

<span class="n">Sponge</span><span class="p">.</span><span class="na">getAssetManager</span><span class="p">().</span><span class="na">getAsset</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="s">&quot;default.conf&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">().</span><span class="na">copyToFile</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="kc">false</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="n">loader</span> <span class="o">=</span> <span class="n">HoconConfigurationLoader</span><span class="p">.</span><span class="na">builder</span><span class="p">().</span><span class="na">setPath</span><span class="p">(</span><span class="n">path</span><span class="p">).</span><span class="na">build</span><span class="p">();</span>
<span class="n">rootNode</span> <span class="o">=</span> <span class="n">loader</span><span class="p">.</span><span class="na">load</span><span class="p">();</span>
</pre></div>
</div>
<p>Dans cet exemple il est important de savoir que la méthode <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/asset/AssetManager.html#getAsset-java.lang.String-">AssetManager#getAsset(String)</a> prend un chemin relatif au dossier d’assets de votre plugin. Donc si l’ID du plugin est <code class="docutils literal notranslate"><span class="pre">myplugin</span></code>, le fichier <code class="docutils literal notranslate"><span class="pre">default.conf</span></code> ne doit pas se situer à la racine du jar, mais dans le dossier <code class="docutils literal notranslate"><span class="pre">assets/myplugin</span></code>. Cet exemple utilise aussi <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/asset/Asset.html#copyToFile-java.nio.file.Path-boolean-boolean-">Asset#copyToFile(Path, boolean, boolean)</a> qui permet également de remplacer le contenu du fichier si voulu.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Si le fichier de configuration ne peut pas être trouvé à l’intérieur du jar de votre plugin, alors vous aurez une <code class="docutils literal notranslate"><span class="pre">NoSuchElementException</span></code> sur la méthode <code class="docutils literal notranslate"><span class="pre">Optional&lt;Asset&gt;.get()</span></code>. Assurez-vous que avez configuré votre <a class="reference internal" href="../buildsystem.html"><span class="doc">build system</span></a> pour l’inclure dans le jar.</p>
</div>
<p>Si vous avez une classe de configuration en plus, vous pouvez utiliser une approche bien plus simple qui fonctionne également si seulement une partie de votre configuration est manquante. Voir également des exemples sur la page <a class="reference internal" href="serialization.html"><span class="doc">Sérialisation d’objets</span></a>.</p>
</div>
<div class="section" id="updating-configuration-files-from-the-default-configuration">
<h2>Mettre à jour la configuration à partir de valeurs par défaut<a class="headerlink" href="#updating-configuration-files-from-the-default-configuration" title="Lien permanent vers ce titre">¶</a></h2>
<p>Il est possible de fusionner de nouveaux nœuds dans le <code class="docutils literal notranslate"><span class="pre">CommentedConfigurationNode</span></code> d’une configuration existante en chargeant les valeurs d’un asset comme expliqué plus haut. Il placera chaque nœud de l’asset dans le nouveau nœud racine s’il n’existe pas déjà.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">PluginContainer</span> <span class="n">plugin</span> <span class="o">=</span> <span class="p">...;</span>

<span class="n">node</span><span class="p">.</span><span class="na">mergeValuesFrom</span><span class="p">(</span><span class="n">HoconConfigurationLoader</span><span class="p">.</span><span class="na">builder</span><span class="p">()</span>
                    <span class="p">.</span><span class="na">setURL</span><span class="p">(</span><span class="n">plugin</span><span class="p">.</span><span class="na">getAsset</span><span class="p">(</span><span class="s">&quot;default.conf&quot;</span><span class="p">).</span><span class="na">get</span><span class="p">().</span><span class="na">getUrl</span><span class="p">())</span>
                    <span class="p">.</span><span class="na">build</span><span class="p">()</span>
                    <span class="p">.</span><span class="na">load</span><span class="p">(</span><span class="n">ConfigurationOptions</span><span class="p">.</span><span class="na">defaults</span><span class="p">()));</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Ça ne changera pas les nœuds existants, on peut donc l’utiliser sans vérifier si le serveur utilisait une version précédente de votre configuration.</p>
</div>
</div>
</div>

           </div>
          </div>
<footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="nodes.html" class="btn btn-neutral float-right" title="Configuration des Nodes" accesskey="n" rel="next">Suivant <span class="fa fa-angle-right"></span></a>
        <a href="index.html" class="btn btn-neutral" title="Configuration des plugins" accesskey="p" rel="prev"><span class="fa fa-angle-left"></span> Précédent</a>
    </div>

    <hr/>

    <section id="license-footer">
        <p>Except where otherwise noted,
            <a xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" property="dct:title" rel="cc:attributionURL" href="https://github.com/SpongePowered/SpongeDocs">SpongeDocs</a>
            is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
        </p>
        <a id="license-icons" rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" title="CC-BY-SA" aria-hidden="true">cba</a>
    </section>
</footer>        </div>
      </div>

    </section>

  </div>


<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <i class="fa fa-book"> <span>SpongeDocs</span></i>
        v: 7.2.0
    <img src="../../_static/flags/fr_FR.svg"
         alt="fr" title="Français">
        <span class="fa fa-caret-down"></span>
    </span>
    <div id="versions" class="rst-other-versions">




    </div>
</div>

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'7.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>      <script type="text/javascript" src="../../_static/jquery.js"></script>      <script type="text/javascript" src="../../_static/underscore.js"></script>      <script type="text/javascript" src="../../_static/doctools.js"></script>      <script type="text/javascript" src="../../_static/language_data.js"></script>      <script type="text/javascript" src="../../_static/translations.js"></script>      <script type="text/javascript" src="../../_static/spongedocs.js"></script>

    <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
 
</body>
</html>