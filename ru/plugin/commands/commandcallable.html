
<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Низкоуровневый API команд &mdash; Документация Sponge 7.2.0</title>

    <link rel="shortcut icon" href="../../_static/favicon.ico"/>




    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />

    <link rel="stylesheet" href="../../_static/spongedocs.css" type="text/css" />

        <link rel="index" title="Алфавитный указатель"
              href="../../genindex.html"/>        <link rel="search" title="Поиск" href="../../search.html"/>    <link rel="top" title="Документация Sponge 7.2.0" href="../../index.html"/>        <link rel="up" title="Команды" href="index.html"/>        <link rel="next" title="События" href="../event/index.html"/>        <link rel="prev" title="Менеджер команд" href="service.html"/>
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
    <div id="sp-logo-container" class="page-scroll">
        <a class="logo" href="../../index.html">
            <img src="../../_static/spongie-mark-dark.svg">
            <span>Sponge</span>
            <i class="fa fa-fw fa-chevron-down"></i>
        </a>
        <div id="sp-logo-menu">
            <ul id="sp-logo-dropdown">
                <li><a href="https://www.spongepowered.org"><i class="fa-fw fa fa-home"></i>Homepage</a></li>
                <li><a href="https://forums.spongepowered.org"><i class="fa-fw fa fa-comments"></i>Forums</a></li>
                <li><a href="https://github.com/SpongePowered"><i class="fa-fw fa fa-code"></i>Code</a></li>
                <li class="active"><a href="https://docs.spongepowered.org"><i class="fa-fw fa fa-book"></i>Docs</a></li>
                <li><a href="https://jd.spongepowered.org"><i class="fa-fw fa fa-graduation-cap"></i>Javadocs</a></li>
                <li><a href="https://forums.spongepowered.org/c/plugins/plugin-releases"><i class="fa-fw fa fa-plug"></i>Plugins</a></li>
                <li><a href="https://ore.spongepowered.org"><img src="../../_static/ore.svg" alt="" class="fa-fw fa ore-logo">Ore <sup>Beta</sup></a></li>
                <li><a href="https://www.spongepowered.org/downloads"><i class="fa-fw fa fa-download"></i>Downloads</a></li>
                <li><a href="https://www.spongepowered.org/chat"><i class="fa-fw fa fa-comment"></i>Chat</a></li>
            </ul>
        </div>
    </div>

<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../server/index.html">Создание сервера</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../versions/index.html">Versioning Policy</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../preparing/index.html">Подготовка к разработке</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Создание плагина</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api-versions.html">Версии API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../buildsystem.html">Система сборки</a></li>
<li class="toctree-l2"><a class="reference internal" href="../workspace/index.html">Подготовка рабочего пространства</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project/index.html">Настройка проекта</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-identifier.html">Идентификаторы плагина</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-class.html">Основной класс плагина</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lifecycle.html">Жизненный цикл плагина</a></li>
<li class="toctree-l2"><a class="reference internal" href="../injection.html">Внедрение зависимостей</a></li>
<li class="toctree-l2"><a class="reference internal" href="../practices/index.html">Полезные советы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../optional/index.html">Дополнительно</a></li>
<li class="toctree-l2"><a class="reference internal" href="../logging.html">Ведение логов (журналов) и отладка</a></li>
<li class="toctree-l2"><a class="reference internal" href="../text/index.html">Текст</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Команды</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="creating.html">Создание команды</a></li>
<li class="toctree-l3"><a class="reference internal" href="arguments.html">Парсинг аргументов</a></li>
<li class="toctree-l3"><a class="reference internal" href="flags.html">Флаги команд</a></li>
<li class="toctree-l3"><a class="reference internal" href="childcommands.html">Дочерние команды</a></li>
<li class="toctree-l3"><a class="reference internal" href="service.html">Менеджер команд</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Низкоуровневый API команд</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../event/index.html">События</a></li>
<li class="toctree-l2"><a class="reference internal" href="../configuration/index.html">Настройка плагинов</a></li>
<li class="toctree-l2"><a class="reference internal" href="../assets.html">API ресурсов</a></li>
<li class="toctree-l2"><a class="reference internal" href="../data/index.html">API данных</a></li>
<li class="toctree-l2"><a class="reference internal" href="../blocks/index.html">Блоки</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entities/index.html">Сущности</a></li>
<li class="toctree-l2"><a class="reference internal" href="../items/index.html">Предметы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../trade-offers.html">Торговля</a></li>
<li class="toctree-l2"><a class="reference internal" href="../effects.html">Эффекты</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduler.html">Планировщик</a></li>
<li class="toctree-l2"><a class="reference internal" href="../services.html">Сервисы</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database.html">Базы данных</a></li>
<li class="toctree-l2"><a class="reference internal" href="../permissions.html">Разрешения</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bans.html">Баны</a></li>
<li class="toctree-l2"><a class="reference internal" href="../metrics.html">Сбор данных</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bookview.html">Книга просмотров</a></li>
<li class="toctree-l2"><a class="reference internal" href="../economy/index.html">Экономика</a></li>
<li class="toctree-l2"><a class="reference internal" href="../wgen/index.html">Генерация мира</a></li>
<li class="toctree-l2"><a class="reference internal" href="../manager.html">Менеджер плагинов</a></li>
<li class="toctree-l2"><a class="reference internal" href="../game-profile-manager.html">Игровой менеджер профилей</a></li>
<li class="toctree-l2"><a class="reference internal" href="../offline-userplayer-data.html">Данные о вышедших игроках</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tab-lists.html">Таблисты</a></li>
<li class="toctree-l2"><a class="reference internal" href="../plugin-meta.html">Метаданные плагина</a></li>
<li class="toctree-l2"><a class="reference internal" href="../ray-tracing.html">Трассировка лучей</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging.html">Отладка плагина</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html">Учебные руководства</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internals/index.html">Implementation-dependent Plugins</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../ore/index.html">Документация Ore</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../contributing/index.html">Участие в разработке Sponge</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../about/index.html">О проекте Sponge</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Sponge</a>
      </nav>


      <div class="wy-nav-content">
        <div class="rst-content">

 

<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
          <li><a href="../index.html">Создание плагина</a> &raquo;</li>
          <li><a href="index.html">Команды</a> &raquo;</li>
    <li>Низкоуровневый API команд</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/plugin/commands/commandcallable.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
  <div class="section" id="low-level-command-api">
<h1>Низкоуровневый API команд<a class="headerlink" href="#low-level-command-api" title="Ссылка на этот заголовок">¶</a></h1>
<p>The <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/CommandCallable.html">CommandCallable</a> and <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/dispatcher/Dispatcher.html">Dispatcher</a> interfaces can be used to define commands. The interfaces can
be used as a base for custom command APIs.</p>
<p>It is recommended to use the <a class="reference internal" href="creating.html"><span class="doc">Command Builder API</span></a> for simple command definitions.</p>
<div class="section" id="writing-a-command">
<h2>Написание команды<a class="headerlink" href="#writing-a-command" title="Ссылка на этот заголовок">¶</a></h2>
<p>Первым шагом является создание класса для команды. Класс нуждается в внедрении интерфейса <code class="docutils literal notranslate"><span class="pre">CommandCallable</span></code>:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.Sponge</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.text.Text</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.CommandCallable</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.CommandException</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.CommandResult</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">org.spongepowered.api.command.CommandSource</span><span class="p">;</span>

<span class="kn">import</span> <span class="nn">java.util.Collections</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span> <span class="nn">java.util.Optional</span><span class="p">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBroadcastCommand</span> <span class="kd">implements</span> <span class="n">CommandCallable</span> <span class="p">{</span>

    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Optional</span><span class="o">&lt;</span><span class="n">Text</span><span class="o">&gt;</span> <span class="n">desc</span> <span class="o">=</span> <span class="n">Optional</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;Displays a message to all players&quot;</span><span class="p">));</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Optional</span><span class="o">&lt;</span><span class="n">Text</span><span class="o">&gt;</span> <span class="n">help</span> <span class="o">=</span> <span class="n">Optional</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;Displays a message to all players. It has no color support!&quot;</span><span class="p">));</span>
    <span class="kd">private</span> <span class="kd">final</span> <span class="n">Text</span> <span class="n">usage</span> <span class="o">=</span> <span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;&lt;message&gt;&quot;</span><span class="p">);</span>

    <span class="kd">public</span> <span class="n">CommandResult</span> <span class="nf">process</span><span class="p">(</span><span class="n">CommandSource</span> <span class="n">source</span><span class="p">,</span> <span class="n">String</span> <span class="n">arguments</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">CommandException</span> <span class="p">{</span>
        <span class="n">Sponge</span><span class="p">.</span><span class="na">getServer</span><span class="p">().</span><span class="na">getBroadcastChannel</span><span class="p">().</span><span class="na">send</span><span class="p">(</span><span class="n">Text</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="n">arguments</span><span class="p">));</span>
        <span class="k">return</span> <span class="n">CommandResult</span><span class="p">.</span><span class="na">success</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">testPermission</span><span class="p">(</span><span class="n">CommandSource</span> <span class="n">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">source</span><span class="p">.</span><span class="na">hasPermission</span><span class="p">(</span><span class="s">&quot;myplugin.broadcast&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Optional</span><span class="o">&lt;</span><span class="n">Text</span><span class="o">&gt;</span> <span class="nf">getShortDescription</span><span class="p">(</span><span class="n">CommandSource</span> <span class="n">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">desc</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Optional</span><span class="o">&lt;</span><span class="n">Text</span><span class="o">&gt;</span> <span class="nf">getHelp</span><span class="p">(</span><span class="n">CommandSource</span> <span class="n">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">help</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">Text</span> <span class="nf">getUsage</span><span class="p">(</span><span class="n">CommandSource</span> <span class="n">source</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">usage</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="nf">getSuggestions</span><span class="p">(</span><span class="n">CommandSource</span> <span class="n">source</span><span class="p">,</span> <span class="n">String</span> <span class="n">arguments</span><span class="p">,</span> <span class="nd">@Nullable</span> <span class="n">Location</span><span class="o">&lt;</span><span class="n">World</span><span class="o">&gt;</span> <span class="n">targetPosition</span><span class="p">)</span> <span class="kd">throws</span> <span class="n">CommandException</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">Collections</span><span class="p">.</span><span class="na">emptyList</span><span class="p">();</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="first admonition-title">Совет</p>
<p class="last">See the JavaDoc for <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/CommandCallable.html">CommandCallable</a> for the purposes of each method in this example.</p>
</div>
</div>
<div class="section" id="registering-the-command">
<h2>Регистрация команды<a class="headerlink" href="#registering-the-command" title="Ссылка на этот заголовок">¶</a></h2>
<p>Now we can register the class in the <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/CommandManager.html">CommandManager</a>. The <code class="docutils literal notranslate"><span class="pre">CommandManager</span></code> stands as the manager for
watching what commands get typed into chat, and redirecting them to the right command handler.
To register your command, use the method <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/CommandManager.html#register-java.lang.Object-org.spongepowered.api.command.CommandCallable-java.lang.String...-">CommandManager#register(Object, CommandCallable, String…)</a>,
passing your plugin, an instance of the command, and any needed aliases as parameters.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.command.CommandManager</span><span class="p">;</span>

<span class="n">CommandManager</span> <span class="n">cmdService</span> <span class="o">=</span> <span class="n">Sponge</span><span class="p">.</span><span class="na">getCommandManager</span><span class="p">();</span>
<span class="n">PluginContainer</span> <span class="n">plugin</span> <span class="o">=</span> <span class="p">...;</span>
<span class="n">cmdService</span><span class="p">.</span><span class="na">register</span><span class="p">(</span><span class="n">plugin</span><span class="p">,</span> <span class="k">new</span> <span class="n">MyBroadcastCommand</span><span class="p">(),</span> <span class="s">&quot;message&quot;</span><span class="p">,</span> <span class="s">&quot;broadcast&quot;</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Примечание</p>
<p class="last">Аргументы после указания экземпляра команды являются дополнительными вариантами для регистрации команды. Вы можете добавить столько, сколько вы хотите. Первый вариант, который не используется другой командой становится основным. Это означает, что варианты используемые другой командой игнорируются.</p>
</div>
</div>
<div class="section" id="command-dispatchers">
<h2>Command Dispatchers<a class="headerlink" href="#command-dispatchers" title="Ссылка на этот заголовок">¶</a></h2>
<p>Command dispatchers can be used to create hierarchical command structures (subcommands).</p>
<p>The default implementation of the <code class="docutils literal notranslate"><span class="pre">Dispatcher</span></code> interface is the <a class="reference external" href="https://spongedl.neptunepowered.org/javadocs/7.2.0/org/spongepowered/api/command/dispatcher/SimpleDispatcher.html">SimpleDispatcher</a> class.</p>
<p>A <code class="docutils literal notranslate"><span class="pre">Dispatcher</span></code> is also a <code class="docutils literal notranslate"><span class="pre">CommandCallable</span></code>, so it can be registered like any other command.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">org.spongepowered.api.command.dispatcher.SimpleDispatcher</span><span class="p">;</span>

<span class="n">CommandCallable</span> <span class="n">subCommand1</span> <span class="o">=</span> <span class="p">...;</span>
<span class="n">CommandCallable</span> <span class="n">subCommand2</span> <span class="o">=</span> <span class="p">...;</span>

<span class="n">SimpleDispatcher</span> <span class="n">rootCommand</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SimpleDispatcher</span><span class="p">();</span>

<span class="n">rootCommand</span><span class="p">.</span><span class="na">register</span><span class="p">(</span><span class="n">subCommand1</span><span class="p">,</span> <span class="s">&quot;subcommand1&quot;</span><span class="p">,</span> <span class="s">&quot;sub1&quot;</span><span class="p">);</span>
<span class="n">rootCommand</span><span class="p">.</span><span class="na">register</span><span class="p">(</span><span class="n">subCommand2</span><span class="p">,</span> <span class="s">&quot;subcommand2&quot;</span><span class="p">,</span> <span class="s">&quot;sub2&quot;</span><span class="p">);</span>

<span class="n">Sponge</span><span class="p">.</span><span class="na">getCommandManager</span><span class="p">().</span><span class="na">register</span><span class="p">(</span><span class="k">this</span><span class="p">,</span> <span class="n">rootCommand</span><span class="p">,</span> <span class="s">&quot;root&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>

           </div>
          </div>
<footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../event/index.html" class="btn btn-neutral float-right" title="События" accesskey="n" rel="next">Далее <span class="fa fa-angle-right"></span></a>
        <a href="service.html" class="btn btn-neutral" title="Менеджер команд" accesskey="p" rel="prev"><span class="fa fa-angle-left"></span> Назад</a>
    </div>

    <hr/>

    <section id="license-footer">
        <p>Except where otherwise noted,
            <a xmlns:dct="http://purl.org/dc/terms/" xmlns:cc="http://creativecommons.org/ns#" property="dct:title" rel="cc:attributionURL" href="https://github.com/SpongePowered/SpongeDocs">SpongeDocs</a>
            is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
        </p>
        <a id="license-icons" rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" title="CC-BY-SA" aria-hidden="true">cba</a>
    </section>
</footer>        </div>
      </div>

    </section>

  </div>


<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        <i class="fa fa-book"> <span>SpongeDocs</span></i>
        v: 7.2.0
    <img src="../../_static/flags/ru_RU.svg"
         alt="ru" title="Русский">
        <span class="fa fa-caret-down"></span>
    </span>
    <div id="versions" class="rst-other-versions">




    </div>
</div>

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'7.2.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>      <script type="text/javascript" src="../../_static/jquery.js"></script>      <script type="text/javascript" src="../../_static/underscore.js"></script>      <script type="text/javascript" src="../../_static/doctools.js"></script>      <script type="text/javascript" src="../../_static/language_data.js"></script>      <script type="text/javascript" src="../../_static/translations.js"></script>      <script type="text/javascript" src="../../_static/spongedocs.js"></script>

    <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
 
</body>
</html>